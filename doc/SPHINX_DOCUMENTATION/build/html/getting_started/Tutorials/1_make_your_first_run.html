
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Forward run (lake at rest) &#8212; DassFlow-2D 1.0 documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dassflow.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting_started/Tutorials/1_make_your_first_run';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Forward run (simple channel “q_in”)" href="2_make_your_second_run.html" />
    <link rel="prev" title="compilation" href="../Compilation/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">DassFlow-2D 1.0 documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../Introduction/index.html">
                        Presentation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="../index.html">
                        Getting started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../user_guide/index.html">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../reference/index.html">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../numerical_guide/index.html">
                        Numerical Guide
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../../license/index.html">
                        License
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../Introduction/index.html">
                        Presentation
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="../index.html">
                        Getting started
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../user_guide/index.html">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../reference/index.html">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../numerical_guide/index.html">
                        Numerical Guide
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                <li class="nav-item">
                    <a class="nav-link" href="../../license/index.html">
                        License
                    </a>
                </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Compilation/index.html">compilation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Forward run (lake at rest)</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_make_your_second_run.html">Forward run (simple channel “q_in”)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_make_your_first_4Dvar.html">Inference run</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_inference-python.html">Inference run using scipy.minimize</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_upgrade-to-parallel.html">Upgrade to parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_gen-user-data.html">Generate  Basic channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CodingPhilosophy/index.html">Coding Philosophy</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="forward-run-lake-at-rest">
<span id="make-your-first-run"></span><h1>Forward run (lake at rest)<a class="headerlink" href="#forward-run-lake-at-rest" title="Permalink to this heading">#</a></h1>
<p>This tutorial details how to perform a direct/forward run with <code class="xref py py-obj docutils literal notranslate"><span class="pre">dassflow2d</span></code>. The 2D SW equations are here solved on an academic case consisting in a lake at rest. <a href="#id1"><span class="problematic" id="id2">**</span></a>TO_DO ref to eqs &amp; solver used **</p>
<p>The goal of this case is to check whether the equilibrium state is preserved, that is preserving initial states.
More precisely the “Lake at rest” is performed to validate the well-balanced property of the numerical schemes
used in DassFlow. The equilibrium challenged here is the equilibrium between fluxes and gravity source term
<span class="math notranslate nohighlight">\(S_g (U)\)</span> for a perturbed topography.</p>
<a class="reference internal image-reference" href="../../_images/mesh_clim.png"><img alt="../../_images/mesh_clim.png" src="../../_images/mesh_clim.png" style="width: 600px;" /></a>
<p>The perturbed topography looks like:</p>
<a class="reference internal image-reference" href="../../_images/bathy_0.png"><img alt="../../_images/bathy_0.png" src="../../_images/bathy_0.png" style="width: 600px;" /></a>
<section id="run-lake-at-rest-case-with-command-lines">
<h2>Run “lake at rest” case with command lines<a class="headerlink" href="#run-lake-at-rest-case-with-command-lines" title="Permalink to this heading">#</a></h2>
<section id="set-up-your-environment">
<h3>Set up your environment<a class="headerlink" href="#set-up-your-environment" title="Permalink to this heading">#</a></h3>
<p>Prepare the simulation files corresponding to “lake at rest” case with:</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>File copy and compilation has just been performed in <a class="reference internal" href="../index.html#getting-started"><span class="std std-ref">Getting started</span></a> introduction, during <a class="reference internal" href="../Installation/index.html#installation"><span class="std std-ref">Installation</span></a> process. Thus, you don’t need to compile the code again.</p>
</div>
<p>Open a terminal in (<em class="xref py py-obj">/dassflow2d-wrap/code</em>) and run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># delete all files in your simulation directory before starting</span>
rm -r ./bin_A/*
<span class="c1"># Copy recursively the files provided in DassFlow case repository into your own simulation directory **code/bin_A/**.</span>
cp -r ../cases/tuto_case/1_lake-at-rest/bin_A/* ./bin_A
</pre></div>
</div>
<p>Note that this test case “lake at rest” can be viewed as a stability test case where the well-balancedness of the numerical scheme (see. <em class="xref py py-obj">Math_num_doc</em>) is tested in terms of equilibrium preservation. It is a simple test case for which, all the boundaries are set as walls and no inflow or outflow occurs.</p>
</section>
<section id="launch-your-first-run-using-make">
<h3>Launch your first run using make<a class="headerlink" href="#launch-your-first-run-using-make" title="Permalink to this heading">#</a></h3>
<p>Write the following command in your terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make rundirect
</pre></div>
</div>
<p>This executes some commands coded in the Makefile and printed in the terminal at the beginning of the execution:</p>
<a class="reference internal image-reference" href="../../_images/tuto1_make_rundirect_initialization.png"><img alt="../../_images/tuto1_make_rundirect_initialization.png" src="../../_images/tuto1_make_rundirect_initialization.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../_images/tuto1_make_rundirect_initialization.png"><img alt="../../_images/tuto1_make_rundirect_initialization.png" src="../../_images/tuto1_make_rundirect_initialization.png" style="width: 600px;" /></a>
<p>You should see in the terminal the successive temporal iterations of the numerical resolution of the 2D SW model.</p>
</section>
<section id="investigate-results">
<h3>Investigate results<a class="headerlink" href="#investigate-results" title="Permalink to this heading">#</a></h3>
<p>Have a look to directory ./dassflow2d-wrap/code/bin_A/res/ and investiguate the result files produced (<em class="xref py py-obj">result_initial.dat</em> and <em class="xref py py-obj">result_final.dat</em>).
These dat files are in gnuplot format (cf. <a class="reference external" href="http://www.gnuplot.info/">http://www.gnuplot.info/</a>) ; another output format as well as plot tools are available in DassFlow and presented after.</p>
</section>
</section>
<section id="run-lake-at-rest-case-with-python">
<h2>Run “lake at rest” case with Python<a class="headerlink" href="#run-lake-at-rest-case-with-python" title="Permalink to this heading">#</a></h2>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#####################################################################</span>
<span class="c1">#####################################################################</span>
<span class="c1"># PERFORM A DIRECT SIMULATION WITH  DASSFLOW2D</span>
<span class="c1"># LAKE AT REST</span>
<span class="c1">#</span>
<span class="c1"># Introduction to basic commands of run and visualisation of results</span>
<span class="c1">#####################################################################</span>
<span class="c1">#####################################################################</span>


<span class="c1">#=======================================================#</span>
<span class="c1"># Source librairies</span>
<span class="c1">#=======================================================#</span>

<span class="kn">import</span> <span class="nn">dassflow2d</span> <span class="k">as</span> <span class="nn">df2d</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">#=======================================================#</span>
<span class="c1"># copy of case files</span>
<span class="c1">#=======================================================#</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../../&#39;</span><span class="p">)</span>
<span class="n">dassflow_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="c1"># DassFlow directory (you can also impose your absolute path)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dassflow_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DassFlow directory is: &quot;</span><span class="p">,</span> <span class="n">dassflow_dir</span><span class="p">)</span>

<span class="c1"># Define directory where case is run</span>
<span class="c1"># (its name &#39;bin_A&#39; is imposed in  {dassflow_dir}/code/makefile.inc : CASEDIR=&#39;bin_A&#39;)</span>
<span class="n">run_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dassflow_dir</span><span class="si">}</span><span class="s2">/code/bin_A/&quot;</span>

<span class="c1"># Define directory containing case data</span>
<span class="n">case_data_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dassflow_dir</span><span class="si">}</span><span class="s2">/cases/tuto_case/1_lake-at-rest/bin_A/&quot;</span>

<span class="c1"># Clean run directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rm -r </span><span class="si">{</span><span class="n">run_dir</span><span class="si">}</span><span class="s2">*&quot;</span><span class="p">)</span>

<span class="c1"># Copy case data to runing directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cp -r </span><span class="si">{</span><span class="n">case_data_dir</span><span class="si">}</span><span class="s2">* </span><span class="si">{</span><span class="n">run_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Copy of case files from existing case to bin_A</span>

<span class="c1"># Move to</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dassflow_dir</span><span class="si">}</span><span class="s2">/code/&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;make cleanres cleanmin&quot;</span><span class="p">)</span> <span class="c1"># Clean forward run and minimization results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>DassFlow directory is:  /home/pagarambois/Documents/Distant/dassflow2d_git_/dassflow2d
make[1]: Entering directory &#39;/home/pagarambois/Documents/Distant/dassflow2d_git_/dassflow2d/code&#39;
rm -rf ./bin_A/res/*
rm -rf ./bin_A/graph/*
rm -rf ./bin_A/min/*
make[1]: Leaving directory &#39;/home/pagarambois/Documents/Distant/dassflow2d_git_/dassflow2d/code&#39;
</pre></div>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#=======================================================#</span>
<span class="c1"># initialization</span>
<span class="c1">#=======================================================#</span>

<span class="c1"># Creation of dassflowmodel object using case data:</span>
<span class="n">my_model</span> <span class="o">=</span> <span class="n">df2d</span><span class="o">.</span><span class="n">dassflowmodel</span><span class="p">(</span><span class="n">bin_dir</span> <span class="o">=</span>  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dassflow_dir</span><span class="si">}</span><span class="s2">/code/bin_A&quot;</span><span class="p">,</span> <span class="n">hdf5_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dassflow_dir</span><span class="si">}</span><span class="s2">/code/bin_A/res/simu.hdf5&quot;</span> <span class="p">,</span> <span class="n">run_type</span> <span class="o">=</span> <span class="s2">&quot;direct&quot;</span><span class="p">,</span> <span class="n">clean</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># Initializion of the Fortran kernel (dassflow Python library is obtained by wrapping Fortran source code)</span>
<span class="c1">#initialise all fortran kernel values and source them into dassflowmodel object</span>
<span class="n">my_model</span><span class="o">.</span><span class="n">init_all</span><span class="p">()</span>
<span class="n">my_model</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">dof</span><span class="o">.</span><span class="n">h</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">dof0</span><span class="o">.</span><span class="n">h</span><span class="p">[:]</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>clean= True
call dassflow2d.wrapping.m_mesh.msh()
call         dassflow2d.wrapping.call_model.init_solver(self.kernel)
call   Meshing(mesh_fortran = self.kernel.mesh)

================================================================================
*  Mesh Loading                                                                *
================================================================================
  mesh%file_nameautomaticaly_generated_mesh.txt                                                                                                 
 INTO calc_cells_connectivity
 STEP 1 DONE
 OUT calc_cells_connectivity
 INLET            0           0
 OUTLET           0           0
================================================================================
*  Mesh Loading is OK                                                          *
================================================================================
 Read_Dass_Mesh OK --&gt; go out
  call Read_Dass_Mesh( mesh ) done 
  call Mesh_Partition_Scotch( mesh ) 
  call Mesh_Geometric_Properties( mesh ) 
  done mesh input 
 call Machine_Number_Limits
 DONE Machine_Number_Limits

********************************************************************************
 range     =             307
 precision =              15
 zerom     =   1.0730891E-16
 pinfm     =   9.4967820E+15
 minfm     =  -9.4967820E+15
 hugem     =   1.7976931+308
 tinym     =   2.2250739-308
********************************************************************************
 call Init_Linear_Solver(mdl%mesh)
 done Init_Linear_Solver(mdl%mesh)
</pre></div>
</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#=======================================================#</span>
<span class="c1"># Run Fortran kernel</span>
<span class="c1">#=======================================================#</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
================================================================================
*  Running Shallow-Water Model in direct mode                                  *
================================================================================
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =      263 t =  3.60209E+02 /  3.60000E+04 (   1.0 % ) , dt =  1.405832E+00
nt =      519 t =  7.21378E+02 /  3.60000E+04 (   2.0 % ) , dt =  1.413758E+00
nt =      773 t =  1.08063E+03 /  3.60000E+04 (   3.0 % ) , dt =  1.414992E+00
nt =     1027 t =  1.44008E+03 /  3.60000E+04 (   4.0 % ) , dt =  1.415243E+00
nt =     1282 t =  1.80097E+03 /  3.60000E+04 (   5.0 % ) , dt =  1.415294E+00
nt =     1536 t =  2.16046E+03 /  3.60000E+04 (   6.0 % ) , dt =  1.415334E+00
nt =     1791 t =  2.52138E+03 /  3.60000E+04 (   7.0 % ) , dt =  1.415362E+00
nt =     2045 t =  2.88088E+03 /  3.60000E+04 (   8.0 % ) , dt =  1.415375E+00
nt =     2299 t =  3.24039E+03 /  3.60000E+04 (   9.0 % ) , dt =  1.415381E+00
nt =     2554 t =  3.60131E+03 /  3.60000E+04 (  10.0 % ) , dt =  1.415384E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =     2808 t =  3.96082E+03 /  3.60000E+04 (  11.0 % ) , dt =  1.415385E+00
nt =     3062 t =  4.32033E+03 /  3.60000E+04 (  12.0 % ) , dt =  1.415386E+00
nt =     3317 t =  4.68125E+03 /  3.60000E+04 (  13.0 % ) , dt =  1.415386E+00
nt =     3571 t =  5.04076E+03 /  3.60000E+04 (  14.0 % ) , dt =  1.415386E+00
nt =     3825 t =  5.40027E+03 /  3.60000E+04 (  15.0 % ) , dt =  1.415386E+00
nt =     4080 t =  5.76119E+03 /  3.60000E+04 (  16.0 % ) , dt =  1.415386E+00
nt =     4334 t =  6.12070E+03 /  3.60000E+04 (  17.0 % ) , dt =  1.415386E+00
nt =     4588 t =  6.48021E+03 /  3.60000E+04 (  18.0 % ) , dt =  1.415386E+00
nt =     4843 t =  6.84113E+03 /  3.60000E+04 (  19.0 % ) , dt =  1.415386E+00
nt =     5097 t =  7.20064E+03 /  3.60000E+04 (  20.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =     5351 t =  7.56015E+03 /  3.60000E+04 (  21.0 % ) , dt =  1.415386E+00
nt =     5606 t =  7.92107E+03 /  3.60000E+04 (  22.0 % ) , dt =  1.415386E+00
nt =     5860 t =  8.28058E+03 /  3.60000E+04 (  23.0 % ) , dt =  1.415386E+00
nt =     6114 t =  8.64008E+03 /  3.60000E+04 (  24.0 % ) , dt =  1.415386E+00
nt =     6369 t =  9.00101E+03 /  3.60000E+04 (  25.0 % ) , dt =  1.415386E+00
nt =     6623 t =  9.36052E+03 /  3.60000E+04 (  26.0 % ) , dt =  1.415386E+00
nt =     6877 t =  9.72002E+03 /  3.60000E+04 (  27.0 % ) , dt =  1.415386E+00
nt =     7132 t =  1.00809E+04 /  3.60000E+04 (  28.0 % ) , dt =  1.415386E+00
nt =     7386 t =  1.04405E+04 /  3.60000E+04 (  29.0 % ) , dt =  1.415386E+00
nt =     7641 t =  1.08014E+04 /  3.60000E+04 (  30.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =     7895 t =  1.11609E+04 /  3.60000E+04 (  31.0 % ) , dt =  1.415386E+00
nt =     8149 t =  1.15204E+04 /  3.60000E+04 (  32.0 % ) , dt =  1.415386E+00
nt =     8404 t =  1.18813E+04 /  3.60000E+04 (  33.0 % ) , dt =  1.415386E+00
nt =     8658 t =  1.22408E+04 /  3.60000E+04 (  34.0 % ) , dt =  1.415386E+00
nt =     8912 t =  1.26003E+04 /  3.60000E+04 (  35.0 % ) , dt =  1.415386E+00
nt =     9167 t =  1.29613E+04 /  3.60000E+04 (  36.0 % ) , dt =  1.415386E+00
nt =     9421 t =  1.33208E+04 /  3.60000E+04 (  37.0 % ) , dt =  1.415386E+00
nt =     9675 t =  1.36803E+04 /  3.60000E+04 (  38.0 % ) , dt =  1.415386E+00
nt =     9930 t =  1.40412E+04 /  3.60000E+04 (  39.0 % ) , dt =  1.415386E+00
nt =    10184 t =  1.44007E+04 /  3.60000E+04 (  40.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =    10438 t =  1.47602E+04 /  3.60000E+04 (  41.0 % ) , dt =  1.415386E+00
nt =    10693 t =  1.51211E+04 /  3.60000E+04 (  42.0 % ) , dt =  1.415386E+00
nt =    10947 t =  1.54806E+04 /  3.60000E+04 (  43.0 % ) , dt =  1.415386E+00
nt =    11201 t =  1.58402E+04 /  3.60000E+04 (  44.0 % ) , dt =  1.415386E+00
nt =    11456 t =  1.62011E+04 /  3.60000E+04 (  45.0 % ) , dt =  1.415386E+00
nt =    11710 t =  1.65606E+04 /  3.60000E+04 (  46.0 % ) , dt =  1.415386E+00
nt =    11964 t =  1.69201E+04 /  3.60000E+04 (  47.0 % ) , dt =  1.415386E+00
nt =    12219 t =  1.72810E+04 /  3.60000E+04 (  48.0 % ) , dt =  1.415386E+00
nt =    12473 t =  1.76405E+04 /  3.60000E+04 (  49.0 % ) , dt =  1.415386E+00
nt =    12727 t =  1.80000E+04 /  3.60000E+04 (  50.0 % ) , dt =  1.415386E+00
==============================================================================
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>==
*  Writing Result File                                                         *
================================================================================
nt =    12982 t =  1.83610E+04 /  3.60000E+04 (  51.0 % ) , dt =  1.415386E+00
nt =    13236 t =  1.87205E+04 /  3.60000E+04 (  52.0 % ) , dt =  1.415386E+00
nt =    13491 t =  1.90814E+04 /  3.60000E+04 (  53.0 % ) , dt =  1.415386E+00
nt =    13745 t =  1.94409E+04 /  3.60000E+04 (  54.0 % ) , dt =  1.415386E+00
nt =    13999 t =  1.98004E+04 /  3.60000E+04 (  55.0 % ) , dt =  1.415386E+00
nt =    14254 t =  2.01613E+04 /  3.60000E+04 (  56.0 % ) , dt =  1.415386E+00
nt =    14508 t =  2.05208E+04 /  3.60000E+04 (  57.0 % ) , dt =  1.415386E+00
nt =    14762 t =  2.08803E+04 /  3.60000E+04 (  58.0 % ) , dt =  1.415386E+00
nt =    15017 t =  2.12413E+04 /  3.60000E+04 (  59.0 % ) , dt =  1.415386E+00
nt =    15271 t =  2.16008E+04 /  3.60000E+04 (  60.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =    15525 t =  2.19603E+04 /  3.60000E+04 (  61.0 % ) , dt =  1.415386E+00
nt =    15780 t =  2.23212E+04 /  3.60000E+04 (  62.0 % ) , dt =  1.415386E+00
nt =    16034 t =  2.26807E+04 /  3.60000E+04 (  63.0 % ) , dt =  1.415386E+00
nt =    16288 t =  2.30402E+04 /  3.60000E+04 (  64.0 % ) , dt =  1.415386E+00
nt =    16543 t =  2.34011E+04 /  3.60000E+04 (  65.0 % ) , dt =  1.415386E+00
nt =    16797 t =  2.37607E+04 /  3.60000E+04 (  66.0 % ) , dt =  1.415386E+00
nt =    17051 t =  2.41202E+04 /  3.60000E+04 (  67.0 % ) , dt =  1.415386E+00
nt =    17306 t =  2.44811E+04 /  3.60000E+04 (  68.0 % ) , dt =  1.415386E+00
nt =    17560 t =  2.48406E+04 /  3.60000E+04 (  69.0 % ) , dt =  1.415386E+00
nt =    17814 t =  2.52001E+04 /  3.60000E+04 (  70.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =    18069 t =  2.55610E+04 /  3.60000E+04 (  71.0 % ) , dt =  1.415386E+00
nt =    18323 t =  2.59205E+04 /  3.60000E+04 (  72.0 % ) , dt =  1.415386E+00
nt =    18577 t =  2.62800E+04 /  3.60000E+04 (  73.0 % ) , dt =  1.415386E+00
nt =    18832 t =  2.66410E+04 /  3.60000E+04 (  74.0 % ) , dt =  1.415386E+00
nt =    19086 t =  2.70005E+04 /  3.60000E+04 (  75.0 % ) , dt =  1.415386E+00
nt =    19341 t =  2.73614E+04 /  3.60000E+04 (  76.0 % ) , dt =  1.415386E+00
nt =    19595 t =  2.77209E+04 /  3.60000E+04 (  77.0 % ) , dt =  1.415386E+00
nt =    19849 t =  2.80804E+04 /  3.60000E+04 (  78.0 % ) , dt =  1.415386E+00
nt =    20104 t =  2.84413E+04 /  3.60000E+04 (  79.0 % ) , dt =  1.415386E+00
nt =    20358 t =  2.88008E+04 /  3.60000E+04 (  80.0 % ) 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>, dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =    20612 t =  2.91604E+04 /  3.60000E+04 (  81.0 % ) , dt =  1.415386E+00
nt =    20867 t =  2.95213E+04 /  3.60000E+04 (  82.0 % ) , dt =  1.415386E+00
nt =    21121 t =  2.98808E+04 /  3.60000E+04 (  83.0 % ) , dt =  1.415386E+00
nt =    21375 t =  3.02403E+04 /  3.60000E+04 (  84.0 % ) , dt =  1.415386E+00
nt =    21630 t =  3.06012E+04 /  3.60000E+04 (  85.0 % ) , dt =  1.415386E+00
nt =    21884 t =  3.09607E+04 /  3.60000E+04 (  86.0 % ) , dt =  1.415386E+00
nt =    22138 t =  3.13202E+04 /  3.60000E+04 (  87.0 % ) , dt =  1.415386E+00
nt =    22393 t =  3.16812E+04 /  3.60000E+04 (  88.0 % ) , dt =  1.415386E+00
nt =    22647 t =  3.20407E+04 /  3.60000E+04 (  89.0 % ) , dt =  1.415386E+00
nt =    22901 t =  3.24002E+04 /  3.60000E+04 (  90.0 % ) , dt =  1.415386E+00
================================================================================
*  Writing Result File                                                         *
================================================================================
nt =    23156 t =  3.27611E+04 /  3.60000E+04 (  91.0 % ) , dt =  1.415386E+00
nt =    23410 t =  3.31206E+04 /  3.60000E+04 (  92.0 % ) , dt =  1.415386E+00
nt =    23664 t =  3.34801E+04 /  3.60000E+04 (  93.0 % ) , dt =  1.415386E+00
nt =    23919 t =  3.38410E+04 /  3.60000E+04 (  94.0 % ) , dt =  1.415386E+00
nt =    24173 t =  3.42005E+04 /  3.60000E+04 (  95.0 % ) , dt =  1.415386E+00
nt =    24427 t =  3.45600E+04 /  3.60000E+04 (  96.0 % ) , dt =  1.415386E+00
nt =    24682 t =  3.49210E+04 /  3.60000E+04 (  97.0 % ) , dt =  1.415386E+00
nt =    24936 t =  3.52805E+04 /  3.60000E+04 (  98.0 % ) , dt =  1.415386E+00
nt =    25191 t =  3.56414E+04 /  3.60000E+04 (  99.0 % ) , dt =  1.415386E+00
nt =    25445 t =  3.60000E+04 /  3.60000E+04 ( 100.0 % ) , dt =  5.030642E-01
================================================================================
*  Writing Result File                                                         *
================================================================================
================================================================================
*  End of run of the Shallow-Water Model in direct mode                        *
================================================================================

********************************************************************************
 Time of simulation   =              5.09
********************************************************************************
 Performance          =              0.12 microsecond / dx / dt / proc
********************************************************************************
&gt;&gt;&gt; Outputs initialized 
 - Simulation Result files were loaded from : /home/pagarambois/Documents/Distant/dassflow2d_git_/dassflow2d/code/bin_A/res/ 
</pre></div>
</div>
</div>
</div>
<p>The numerical resolution is performed with variable time steps (depending on the CFL condition) and outputs are written at each writting timestep (imposed by the “dtw” parameter).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#=======================================================#</span>
<span class="c1"># Vizualize parameters and results</span>
<span class="c1">#=======================================================#</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>First, you can have a look at the bathymetry, friction and initial conditions (of water heigth and free surface height).</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot of the 2D bathymetry (input parameter of the 2D shallow water model) with package plot function</span>

<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;bathy&quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Bathymetry elevation&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span><span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1_make_your_first_run_4_0.png" src="../../_images/1_make_your_first_run_4_0.png" />
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the friction parameter field</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;manning_alpha&quot;</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;n [m-1/3.s] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Friction parameter (Manning coefficient)&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span><span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1_make_your_first_run_5_0.png" src="../../_images/1_make_your_first_run_5_0.png" />
</div>
</div>
<p>The friction is uniform as defined in this case setup.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot intial flow conditions</span>

<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;h [m] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Initial water depth&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>

<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;zs&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;zs [m] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Initial water surface elevation&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>

<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;u [m/s] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Initial velocity u along x&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>


<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;v [m/s] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="s2">&quot;Initial velocity v along y&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1_make_your_first_run_6_0.png" src="../../_images/1_make_your_first_run_6_0.png" />
<img alt="../../_images/1_make_your_first_run_6_1.png" src="../../_images/1_make_your_first_run_6_1.png" />
<img alt="../../_images/1_make_your_first_run_6_2.png" src="../../_images/1_make_your_first_run_6_2.png" />
<img alt="../../_images/1_make_your_first_run_6_3.png" src="../../_images/1_make_your_first_run_6_3.png" />
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot flow depth at a given time</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;h [m] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Water depth at time = </span><span class="si">{</span><span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">all_time</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">  s &quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>

<span class="c1"># Simulation time steps at which variables have been written</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">all_time</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;previous plot for t = &quot;</span><span class="p">,</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">all_time</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1_make_your_first_run_7_0.png" src="../../_images/1_make_your_first_run_7_0.png" />
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[    0.     3601.311  7200.637 10801.38  14400.71  18000.03  21600.77
 25200.1   28800.84  32400.17  36000.   ]
previous plot for t =  10801.38
</pre></div>
</div>
</div>
</div>
<p>Let us study the flow state at the end of the simulation</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute velocity magnitude</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">u</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">v</span>
<span class="n">norm_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Print the shape of the output velocity fields</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape of velocity array is : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">norm_vel</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum velocity magnitude at ecah time step is : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">norm_vel</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="c1"># Plot velocity magnitude at final time step</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">my_scalar</span> <span class="o">=</span> <span class="n">norm_vel</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;norm(u,v) [m/s] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Velocity magnitude at final time&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>

<span class="c1"># Plot water surface elevation at final time step</span>

<span class="n">plotter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><span class="n">my_mesh</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">meshing</span><span class="o">.</span><span class="n">mesh_pyvista</span><span class="p">,</span>
                                             <span class="n">what</span> <span class="o">=</span> <span class="s2">&quot;zs&quot;</span><span class="p">,</span>
                                             <span class="n">when</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">title_scale_bar</span> <span class="o">=</span><span class="s2">&quot;zs [m] &quot;</span><span class="p">,</span>
                                             <span class="n">title_plot</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Water surface elevation at final time&quot;</span><span class="p">,</span>
                                             <span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># for a local run remove notebook option or set notebook=False</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jupyter_backend</span><span class="o">=</span><span class="s1">&#39;trame&#39;</span><span class="p">)</span> <span class="c1"># remove jupyter_backend if needed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>shape of velocity array is :  (1600, 11)
Maximum velocity magnitude at ecah time step is :  [0.00000000e+00 3.94337948e-03 5.01612814e-04 6.62154500e-05
 8.79081429e-06 1.16776697e-06 1.54975391e-07 2.05580807e-08
 2.70801607e-09 3.45204829e-10 8.70955869e-11]
</pre></div>
</div>
<img alt="../../_images/1_make_your_first_run_8_1.png" src="../../_images/1_make_your_first_run_8_1.png" />
<img alt="../../_images/1_make_your_first_run_8_2.png" src="../../_images/1_make_your_first_run_8_2.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can see that at the end of the simulation, the velocity magnitude can be considered as null and the water surface elevation as almost constant, hence the lake is at rest.</p>
<p>This result, obtained on a case with non trivial bathymetry and initial state with wall lateral boundary conditions, validates the capability of the numerical scheme in preserving equilibrium.</p>
</div>
<p>You can get information on the configuration of dassflowmodel object with:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The numerical scheme that has been used to solve the 2D shallow water equations is:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Temporal scheme is: &quot;</span><span class="p">,</span> <span class="n">my_model</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;temp_scheme&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spatial scheme is: &quot;</span><span class="p">,</span> <span class="n">my_model</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;spatial_scheme&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;mesh_name&#39;: &#39;automaticaly_generated_mesh.txt&#39;, &#39;ts&#39;: 36000.0, &#39;dta&#39;: 0, &#39;dtw&#39;: 3600.0, &#39;dtp&#39;: 60.0, &#39;dt&#39;: 1.0, &#39;temp_scheme&#39;: &#39;euler&#39;, &#39;spatial_scheme&#39;: &#39;first_b1&#39;, &#39;adapt_dt&#39;: 1, &#39;cfl&#39;: 0.5, &#39;feedback_inflow&#39;: 1, &#39;coef_feedback&#39;: 0.1, &#39;heps&#39;: 0, &#39;friction&#39;: 1, &#39;g&#39;: 9.81, &#39;w_tecplot&#39;: 0, &#39;w_vtk&#39;: 0, &#39;w_gnuplot&#39;: 1, &#39;w_obs&#39;: 0, &#39;use_obs&#39;: 0, &#39;max_nt_for_adjoint&#39;: 100000000, &#39;c_manning&#39;: 0, &#39;c_manning_beta&#39;: 0, &#39;c_bathy&#39;: 0, &#39;c_hydrograph&#39;: 0, &#39;c_ratcurve&#39;: 0, &#39;c_rain&#39;: 0, &#39;c_ic&#39;: 0, &#39;restart_min&#39;: 0, &#39;eps_min&#39;: 0}
The numerical scheme that has been used to solve the 2D shallow water equations is:
Temporal scheme is:  euler
Spatial scheme is:  first_b1
</pre></div>
</div>
</div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The above Python script is available here: <a class="reference download internal" download="" href="../../_downloads/d5755a1bc3208fc336c139a01357f652/1_make_your_first_run.py"><code class="xref download docutils literal notranslate"><span class="pre">1_make_your_first_run.py</span></code></a></p>
<p>A Jupyter Notebook version is available here: <a class="reference download internal" download="" href="../../_downloads/1d7292d2b3a1a4f2c10b14158a86121e/1_make_your_first_run.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">1_make_your_first_run.ipynb</span></code></a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the location of the dassflow directory has to be defined by setting appropriate value to <strong>dassflow_dir</strong>  at the begining of the above script. A relative path has been used here but you can also impose your own absolute path to run a script in terminal or from Python IDE from other directories.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above script can be used to run any other case by simply providing case data with necessary inputs for DassFlow.
In next tutorial we will use this script to run another case.</p>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../Compilation/index.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">compilation</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="2_make_your_second_run.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Forward run (simple channel “q_in”)</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-lake-at-rest-case-with-command-lines">
   Run “lake at rest” case with command lines
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-your-environment">
     Set up your environment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#launch-your-first-run-using-make">
     Launch your first run using make
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#investigate-results">
     Investigate results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-lake-at-rest-case-with-python">
   Run “lake at rest” case with Python
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://gitlab.irstea.fr//lilian.villenave/dassflow2d-wrap/-/edit/documentation//doc/SPHINX_DOCUMENTATION/source/getting_started/Tutorials/1_make_your_first_run.rst">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../_sources/getting_started/Tutorials/1_make_your_first_run.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright Under Cecil licence.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>