#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{color}

\usepackage[affil-it]{authblk}

%\usepackage{indentfirst}

\author[1]{Contributors: see DassFlow webpage}

\affil[1]{Institut de Mathémathiques de Toulouse / INSA / CNRS / INRAe / ICUBE Strasbourg}


\renewcommand\Authands{ and }

\newcommand{\version}{v3.0}
\newcommand{\DassFlow}{\textsc{DassFlow}}

\newcommand{\bin}{\texttt{\textbf{/bin}}}
\newcommand{\cpp}{\texttt{\textbf{/cpp}}}
\newcommand{\doc}{\texttt{\textbf{/doc}}}
\newcommand{\code}{\texttt{\textbf{/code}}}
\newcommand{\libs}{\texttt{\textbf{/libs}}}
\newcommand{\obj}{\texttt{\textbf{/obj}}}
\newcommand{\cases}{\texttt{\textbf{/cases}}}
\newcommand{\souk}{\texttt{\textbf{/souk}}}
\newcommand{\src}{\texttt{\textbf{/src}}}
\newcommand{\tap}{\texttt{\textbf{/tap}}}
\newcommand{\tools}{\texttt{\textbf{/tools}}}

\newcommand{\binres}{\texttt{\textbf{/bin/res}}}
\newcommand{\binmsh}{\texttt{\textbf{/bin/msh}}}
\newcommand{\binobs}{\texttt{\textbf{/bin/obs}}}
\newcommand{\bingrad}{\texttt{\textbf{/bin/grad}}}
\newcommand{\binmin}{\texttt{\textbf{/bin/min}}}

\newcommand{\make}{\texttt{\textbf{Makefile}}}
\newcommand{\exe}{\texttt{\textbf{exe}}}

\newcommand{\inp}{\texttt{\textbf{input.txt}}}
\newcommand{\usr}{\texttt{\textbf{m\_user\_data.f90}}}
\newcommand{\tst}{\texttt{\textbf{m\_user\_test.f90}}}
\newcommand{\bc}{\texttt{\textbf{bc.txt}}}
\newcommand{\obs}{\texttt{\textbf{obs.txt}}}
\newcommand{\paramObs}{\texttt{\textbf{param\_obs.txt}}}
\newcommand{\hydro}{\texttt{\textbf{hydrograph.txt}}}
\newcommand{\rat}{\texttt{\textbf{ratcurve.txt}}}
\newcommand{\landuse}{\texttt{\textbf{land\_use.txt}}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bG}{\mathbf{G}}

\newcommand{\warm}{\includegraphics[scale=0.25]{figs/Symbols-Critical-icon}}

\lhead{\DassFlow{} \version{} - User and Developer Guide}
\rhead{University of Toulouse - INSA/University of Strasbourg/INRAE/CNES/CNRS}
\cfoot{\thepage/\pageref{LastPage}}
\pagestyle{fancy}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lightrulewidth=.04em
\heavyrulewidth=.12em
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement !tbh
\paperfontsize 10
\spacing single
\use_hyperref true
\pdf_title "DassFlow 2 : User and Developer Guide"
\pdf_author "Frederic Couderc"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\headheight 1cm
\headsep 1cm
\footskip 1cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle fancy
\bullet 1 0 15 -1
\bullet 2 0 0 -1
\bullet 3 0 6 -1
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Equations and Numerical Schemes coded in DassFlow2D
\end_layout

\begin_layout Date
March 2022
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Mathematical models & data assimilation features
\end_layout

\begin_layout Standard
DassFlow 2D is an open computational software designed to shallow free surface
 flows with features of Variational Data Assimilation.
 The dynamics flow model can be coupled with a hydrology model, therefore
 providing a complete hydraulic-hydrology model.
\end_layout

\begin_layout Standard
The computational kernel is coded in Fortran 2003 / MPI.
 It is wrapped in Python.
 
\begin_inset Newline newline
\end_inset

In the latest version, the following physical models are available: the
 2D SW equations in variables 
\begin_inset Formula $(h,q_{x},q_{y})$
\end_inset

, its version for Herschel-Bulkley rheology (non Newtonian fluids, power-law
 rheology with threshold) and the GR4H rainfall-rainoff model.
 
\end_layout

\begin_layout Standard
Note that a 1D version of SW system in variables 
\begin_inset Formula $(S,Q)$
\end_inset

 (Saint-Venant's equations) is available but in another DassFlow version
 (please consult DassFlow webpage for details).
 
\end_layout

\begin_layout Subsection
The 2D SW equations for Newtonian fluids
\end_layout

\begin_layout Standard
Let us denote by 
\begin_inset Formula $h$
\end_inset

 the water depth (m), by 
\begin_inset Formula $\mathbf{q}$
\end_inset

 the discharge (
\begin_inset Formula $m^{3}/s$
\end_inset

), 
\begin_inset Formula $\mathbf{q}=h\mathbf{u}$
\end_inset

, 
\begin_inset Formula $\mathbf{u}=(u,v)^{T}$
\end_inset

 the depth-averaged velocity (
\begin_inset Formula $m/s$
\end_inset

).
 
\end_layout

\begin_layout Standard
On a computational domain 
\begin_inset Formula $\Omega\in\mathbb{\mathbb{\mathbb{R}}}^{2}$
\end_inset

 and for a time interval 
\begin_inset Formula $\left[0,T\right]$
\end_inset

, the equations numerically solved are:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{lclcc}
\partial_{t}h+div(\mathbf{q}) & = & 0 & \textrm{in} & \text{Ω}\times]0,T]\\
\\
\partial_{t}\mathbf{q}+div\left(\dfrac{\mathbf{q}\otimes\mathbf{q}}{h}+g\dfrac{h^{2}}{2}Id\right) & +gh\mathbf{\nabla}z_{b} & =-g\dfrac{n^{2}\left\Vert \mathbf{q}\right\Vert }{h^{7/3}}\mathbf{q} & \textrm{in} & \text{Ω}\times]0,T]
\end{array}\right.\label{eq:sw}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $g$
\end_inset

 is the magnitude of the gravity, 
\begin_inset Formula $z_{b}$
\end_inset

 the bed elevation and 
\begin_inset Formula $n$
\end_inset

 the Manning-Strickler roughness coefficient.
\begin_inset Newline newline
\end_inset

It is accompanied by initial and all usual boundary conditions necessary
 for real-world applications.
\end_layout

\begin_layout Standard
In the sequel we denote by: 
\begin_inset Formula $\mathbf{U}=\left(h,\boldsymbol{q}\right)=\left(h,h\boldsymbol{u}\right)=(h,q_{x},q_{y})$
\end_inset

.
 
\end_layout

\begin_layout Subsection
The 2D SW equations for Non-Newtonian fluids (Herschel-Bulkley rheology)
\end_layout

\begin_layout Standard
For non-Newtonian flows, the SW equations with Herschel-Bulkley rheology
 writes:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{lclcc}
\partial_{t}h+div(\mathbf{q}) & = & 0 & \textrm{in} & \text{Ω}\times]0,T]\\
\\
\partial_{t}\mathbf{q}+div\left(\dfrac{\mathbf{q}\otimes\mathbf{q}}{h}+\frac{1}{2}gh^{2}\textrm{cos}\theta\boldsymbol{I}+\xi h^{2m+3}\right) & = & -gh\left(\textrm{cos}\theta\nabla z_{b}-S_{\ensuremath{\theta}}\right)-\frac{1}{\rho}K\boldsymbol{\tau}_{b} & \textrm{in} & \text{Ω}\times]0,T]
\end{array}\right.\label{eq:hb}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where;
\begin_inset Newline newline
\end_inset

 
\begin_inset Formula $\xi=\left[\begin{aligned}\frac{1}{(2m+3)(m+2)^{2}}\left[\frac{\rho g}{K}S_{\ensuremath{\theta}}\right]^{2m}\end{aligned}
\right]$
\end_inset

 and 
\begin_inset Formula $S_{\ensuremath{\theta}}=\begin{cases}
\textrm{sin}\theta & \textrm{for flows with low viscosity }\\
\textrm{sin}\theta-\textrm{cos}\theta\nabla H & \textrm{for flows with relatively high viscosity}
\end{cases}$
\end_inset

 
\begin_inset Newline newline
\end_inset


\begin_inset Formula $K\boldsymbol{\tau}_{b}=\left[\begin{aligned}\tau_{c}+K\left[\frac{\boldsymbol{q}}{\left(h-\frac{\tau_{c}}{\rho gS_{\ensuremath{\theta}}}\right)\left(\frac{1}{m+1}h-\frac{1}{(m+1)(m+2)}\left[h-\frac{\tau_{c}}{\rho gS_{\ensuremath{\theta}}}\right]\right)+\left(\frac{\rho gS_{\ensuremath{\theta}}}{\rho gS_{\ensuremath{\theta}}h-\tau_{c}}\right)^{m}\left(\frac{z_{b}^{m+2}}{(m+1)(m+2)}+Ch^{m+1}\right)}\right]^{\frac{1}{m}}\end{aligned}
\right]$
\end_inset


\begin_inset Newline newline
\end_inset

with;
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\tau_{c}=\rho gS_{\ensuremath{\theta}}h_{p}(z,t)$
\end_inset

, 
\begin_inset Formula $h_{p}(z,t)=h(z,t)-h_{c}(z,t)$
\end_inset

 and 
\begin_inset Formula $m=\frac{1}{n}$
\end_inset

 
\begin_inset Newline newline
\end_inset

where 
\begin_inset Formula $n$
\end_inset

 denotes the power-law index, 
\begin_inset Formula $H$
\end_inset

 the fluid elevation, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\tau_{b}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 the
\series bold
 
\series default
basal shear stress
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\begin_inset Formula $K(T)$
\end_inset

 the consistency index which is temperature-dependent,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $\tau_{c}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 the yield stress
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 ,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $h_{c}$
\end_inset

 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
the thickness of the sheared zone ,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $h_{p}$
\end_inset

 the plug thickness, 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
and 
\begin_inset Formula $C$
\end_inset

 the basal slip coefficient.
 
\end_layout

\begin_layout Standard
Similarly, the usual initial and boundary conditions are imposed.
\end_layout

\begin_layout Subsection
The bucket-type rainfall-runoff model
\end_layout

\begin_layout Standard
The GR4H model (
\begin_inset CommandInset citation
LatexCommand citet
key "mathevet2005quels"
literal "false"

\end_inset

) is a lumped continuous model that runs at the hourly time step.
 It is based on the GR4J model formulation of 
\begin_inset CommandInset citation
LatexCommand citet
key "perrin2003improvement"
literal "false"

\end_inset

 and uses a robust and parsimonious production function proposed in (
\begin_inset CommandInset citation
LatexCommand citet
key "michel1989modele"
literal "false"

\end_inset

).
 It is a well-established, parsimonious and robust model and its state-space
 version (
\begin_inset CommandInset citation
LatexCommand citet
key "santos2018continuous"
literal "false"

\end_inset

) is based on Ordinary Differential Equations (ODEs) hence differentiable.
 This property is a necessary condition to generate an adjoint code.
\end_layout

\begin_layout Standard
Several GR models exist, featuring varying amounts of parameters, stores
 and time steps (see 
\begin_inset CommandInset citation
LatexCommand citet
key "perrin2007modeles"
literal "false"

\end_inset

).
 The 
\begin_inset Quotes eld
\end_inset

state-space
\begin_inset Quotes erd
\end_inset

 version of the GR4H model is described by the following set of ODEs equations:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\mathrm{d}\boldsymbol{h}}{\mathrm{dt}}=\begin{cases}
\dot{h_{p}} & =P_{s}-E_{s}-P_{erc}\\
\dot{h}_{1} & =P_{r}-Q_{Sh,1}\\
\dot{h}_{2} & =Q_{Sh,1}-Q_{Sh,2}\\
... & ...\\
\dot{h}_{nres} & =Q_{Sh,nres-1}-Q_{Sh,nres}\\
\dot{h_{r}} & =Q_{9}+F-Q_{r}
\end{cases}\label{eq:GR4state-space}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It consists in a production store 
\begin_inset Formula $S$
\end_inset

, a routing store 
\begin_inset Formula $R$
\end_inset

 and a series of 11 Nash cascade stores 
\begin_inset Formula $S_{h,i},\,\forall i\in\left[1..11\right]$
\end_inset

.
 The internal model variables are the 13 store levels.
 Four parameters 
\begin_inset Formula $\left(x_{1},\,x_{2},\,x_{3},\,x_{4}\right)$
\end_inset

 rule the draining of the production store, of the routing store, of the
 11 identical cascading stores and the non-conservative exchange law.
 Initial store states are given using a 1 year warm-up period.
 
\end_layout

\begin_layout Standard
They involve the following fluxes:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{cases}
E_{s}= & E\left(\frac{2h_{S}}{c_{1}}-\left(\frac{h_{p}}{c_{1}}\right)^{\alpha}\right)\\
P_{S}= & P\left(1-\left(\frac{h_{p}}{c_{1}}\right)^{\alpha}\right)\\
P_{erc}= & \left(\frac{\nu}{c_{1}}\right)^{\beta-1}\frac{1}{\beta-1}\left(h_{p}^{+}\right)^{\beta}\\
P_{R}= & P\left(\frac{h_{p}}{c_{1}}\right)^{\alpha}+\left(\frac{\nu}{c_{1}}\right)^{\beta-1}\frac{1}{\beta-1}\left(h_{p}^{+}\right)^{\beta}\\
Q_{N1}= & \frac{n_{res}-1}{c_{4}}h_{1}^{+}\\
... & ...\\
Q_{N11}= & \frac{n_{res}-1}{c_{4}}h_{n_{res}}^{+}\\
Q_{9}= & \Phi\frac{n_{res}-1}{c_{4}}h_{n_{res}}^{+}\\
Q_{1}= & \left(1-\Phi\right)\frac{n_{res}-1}{c_{4}}h_{n_{res}}^{+}\\
F= & \frac{c_{2}}{c_{3}^{\omega}}\left(h_{r}^{+}\right)^{\omega}\\
Q_{D}= & \left(1-\Phi\right)\frac{n_{res}-1}{c_{4}}h_{n_{res}+1}-\frac{c_{2}}{c_{3}^{\omega}}\left(h_{r}^{+}\right)^{\omega}\\
Q_{R}= & \frac{1}{\left(h_{R}^{+}\right)^{\gamma-1}\left(\gamma-1\right)}\left(h_{r}^{+}\right)^{\gamma}
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The following parameter are set following 
\begin_inset CommandInset citation
LatexCommand cite
key "perrin2003improvement"
literal "false"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "santos2018continuous"
literal "false"

\end_inset

: 
\begin_inset Formula $\alpha=2$
\end_inset

, 
\begin_inset Formula $\beta=5$
\end_inset

, 
\begin_inset Formula $\gamma=5$
\end_inset

, 
\begin_inset Formula $\omega=3.5$
\end_inset

, 
\begin_inset Formula $\nu=4/9$
\end_inset

, 
\begin_inset Formula $\Phi=0.9$
\end_inset

, 
\begin_inset Formula $n_{res}=11$
\end_inset

.
\end_layout

\begin_layout Subsection
Data Assimilation & inversion capabilities
\end_layout

\begin_layout Standard
The cost functions to be minimized (defined from the direct model output)
 is defined by the user, in particular the cost terms measuring the discrepancy
 between the simulated state and data.
 Data can be provided by external datasets (e.g.
 in-situ or satellites datasets).
 For experiment purposes, datasets can be produced by the code itself (this
 is the twin experiments mode).
 
\end_layout

\begin_layout Standard
The inversions are minimization process requiring the cost function gradient.
 The latter is computed by the adjoint method.
 The adjoint code is generated by performing the Automatic Differentiation
 tool Tapenade 
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset CommandInset href
LatexCommand href
target "http://www-sop.inria.fr/tropics/"
literal "false"

\end_inset


\end_layout

\end_inset

.
 The source code written in Fortran and Makefile(s) have been designed to
 do so.
 
\end_layout

\begin_layout Standard
The cost gradient computation enables to analyse spatially-distributed sensitivi
ties: this the 'local sensitivity mode'.
\begin_inset Newline newline
\end_inset

A complete Variational Data Assimilation process is available.
 This provides a calibrated model from datasets and/or the identification
 of some input parameters values (e.g.
 the bathymetry, some inflows or physical parametrizations) .
 The VDA process is based on local minimization algorithms (generally the
 BFGS algorithm).
 
\end_layout

\begin_layout Standard
Both the direct code and the adjoint code can be runned in parallel (MPI).
\end_layout

\begin_layout Section
Finite Volume schemes
\end_layout

\begin_layout Standard
In this section, we describe the numerical schemes based on Finite Volume
 methods to solve the 2D SW models.
\end_layout

\begin_layout Subsection
Notations and basic principles
\end_layout

\begin_layout Standard
We consider a discretization 
\begin_inset Formula $\text{ℑ}_{h}$
\end_inset

 of a computational domain 
\begin_inset Formula $\Omega$
\end_inset

 with 
\begin_inset Formula $N$
\end_inset

 cells 
\begin_inset Formula $K_{i}$
\end_inset

 (cells can be triangles or quadrilaterals that can be also mixed in practice).
 
\end_layout

\begin_layout Standard
Let us introduce some notations and conventions (see Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mesh"

\end_inset

).
 Considering a given cell 
\begin_inset Formula $K$
\end_inset

 (omitting above 
\begin_inset Formula $i$
\end_inset

 index),
\end_layout

\begin_layout Itemize
\begin_inset Formula $m_{K}$
\end_inset

 is the area of the cell 
\begin_inset Formula $K$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $m_{\partial K}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 its perimeter and 
\begin_inset Formula $x_{K}$
\end_inset

 its barycenter.
\end_layout

\begin_layout Itemize
\begin_inset Formula $e$
\end_inset

 is one of the 
\begin_inset Formula $\delta K$
\end_inset

 boundary edges, 
\begin_inset Formula $m_{e}$
\end_inset

 its length and 
\begin_inset Formula $x_{e}$
\end_inset

 its center.
\end_layout

\begin_layout Itemize
\begin_inset Formula $K_{e}$
\end_inset

 is the neighboring cell to 
\begin_inset Formula $K$
\end_inset

 across 
\begin_inset Formula $e$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{n}_{e,K}$
\end_inset

 is the unit normal to 
\begin_inset Formula $e$
\end_inset

 oriented from 
\begin_inset Formula $K$
\end_inset

 to 
\begin_inset Formula $K_{e}$
\end_inset

.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/mesh.pdf
	lyxscale 50
	width 25text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Notations and conventions for mesh discretization and numerical schemes
 associated.
\begin_inset CommandInset label
LatexCommand label
name "fig:mesh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The SW equations can be written in their conservative form as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\text{\ensuremath{\partial}}_{t}\mathbf{U}+\text{\ensuremath{\partial}}_{x}\text{\underbar{\textbf{F}}}(\mathbf{U})+\text{\ensuremath{\partial}}_{y}\mathbf{\text{\underbar{\ensuremath{G}}}}(\mathbf{U})\:=\:\mathbf{S}_{g}(\mathbf{U})+\mathbf{S}_{f}(\mathbf{U})\\
\\
\begin{array}{c}
\mathbf{U}=\begin{bmatrix}h\\
hu\\
hv
\end{bmatrix}\:,\:\mathbf{\text{\underbar{\textbf{F}}}}(\mathbf{U})=\begin{bmatrix}hu\\
hu^{2}+{\displaystyle g\frac{h^{2}}{2}}\\
huv
\end{bmatrix}\:,\:\mathbf{\text{\underbar{\textbf{G}}}}(\mathbf{U})=\begin{bmatrix}hv\\
huv\\
hv^{2}+{\displaystyle g\frac{h^{2}}{2}}
\end{bmatrix}\:,\\
\\
\mathbf{S}_{g}(z_{b};\mathbf{U})=-g\begin{bmatrix}0\\
h\mathbf{\nabla}z_{b}
\end{bmatrix}\:,\:\mathbf{S}_{f}(\mathbf{U})=-gn^{2}\begin{bmatrix}0\\
{\displaystyle \frac{\left\Vert \mathbf{u}\right\Vert }{h^{1/3}}}\mathbf{u}
\end{bmatrix}
\end{array}
\end{array}\label{eq:sw_cons}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The term 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbf{S}_{g}(z_{b};\mathbf{U})$
\end_inset

, resp.
 
\begin_inset Formula $ \mathbf{S}_{f}(\mathbf{U})$
\end_inset

,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
 denotes the gravitational term, resp.
 the friction term.
 
\end_layout

\begin_layout Standard
The expression of 
\begin_inset Formula $\mathbf{S}_{f}(\mathbf{U})$
\end_inset

 above derives from the Manning-Strickler law, with 
\begin_inset Formula $n$
\end_inset

 the Manning coefficient (friction coefficient).
 
\begin_inset Formula $n^{2}=K_{S}^{-1}$
\end_inset

, 
\begin_inset Formula $K_{S}$
\end_inset

 the Strickler coefficient.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Paragraph
Basic principles
\end_layout

\begin_layout Standard
A each time step, the basic principle consists to solve:
\end_layout

\begin_layout Itemize
[prediction phase] the hyperbolic system (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sw_cons"

\end_inset

)
\emph on
 with the pressure term in the source term 
\begin_inset Formula $\mathbf{S}_{g}$
\end_inset

 and without the friction term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

,
\emph default
 that is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\text{\ensuremath{\partial}}_{t}\mathbf{U}+\text{\ensuremath{\partial}}_{x}\mathbf{F}(\mathbf{U})+\text{\ensuremath{\partial}}_{y}\mathbf{G}(\mathbf{U})\:=\mathbf{S}(\eta;\mathbf{U})\\
\begin{array}{c}
\bF(\mathbf{U})=\begin{bmatrix}hu\\
hu^{2}\\
huv
\end{bmatrix}\:,\:\bG(\mathbf{U})=\begin{bmatrix}hv\\
huv\\
hv^{2}
\end{bmatrix}\:,\mathbf{F}(\eta;\mathbb{\mathbf{U}})=-g{\displaystyle h}\begin{bmatrix}0\\
\nabla\eta
\end{bmatrix}\end{array}
\end{array}\label{eq:sw_non_cons}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
[correction phase] the dynamics system with the friction source term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 only: 
\begin_inset Formula $\partial_{t}\boldsymbol{\mathbf{U}}=\mathbf{S}_{f}\left(\mathbf{U}\right)$
\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
We consider the piecewise constant approximation over mesh cells:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{K}={\displaystyle \frac{1}{m_{K}}}\int_{K}\mathbf{U}dK
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We consider a non unform time grid: 
\begin_inset Formula $t^{n+1}=t^{n}+\Delta t^{n}$
\end_inset

.
 
\end_layout

\begin_layout Standard
We denote by 
\begin_inset Formula $\mathbf{U}_{K}^{n}$
\end_inset

 (resp.
 by 
\begin_inset Formula $\mathbf{U}_{K}^{n+1}$
\end_inset

) the piecewise constant approximation of 
\begin_inset Formula $\mathbf{U}$
\end_inset

 at time 
\begin_inset Formula $t^{n}$
\end_inset

 (resp.
 
\begin_inset Formula $t^{n+1}$
\end_inset

).
 Recall that: 
\begin_inset Formula $\mathbf{U}=\left(h,\boldsymbol{q}\right)=\left(h,h\boldsymbol{u}\right)=(h,q_{x},q_{y})$
\end_inset

.
 
\end_layout

\begin_layout Standard
The current cell (
\begin_inset Quotes eld
\end_inset

left cell
\begin_inset Quotes erd
\end_inset

) is denoted by 
\begin_inset Formula $K$
\end_inset

.
 The 
\begin_inset Quotes eld
\end_inset

right cell
\begin_inset Quotes erd
\end_inset

 is denoted by 
\begin_inset Formula $K_{e}$
\end_inset

.
 
\end_layout

\begin_layout Standard
By integrating over 
\begin_inset Formula $K$
\end_inset

, and by applying the Godunov method 
\begin_inset CommandInset citation
LatexCommand cite
key "Godunov1959"
literal "true"

\end_inset

, the semi-discrete scheme for the homogeneous system reads:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{K}^{n+1}=\mathbf{U}_{K}^{n}-{\displaystyle \frac{\Delta t^{n}}{m_{K}}\sum_{e\in\partial K}m_{e}}\mathbf{F}_{e}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K_{e}}^{n},\mathbf{n}_{K}\right)\label{eq:semi-discrete}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The rotational invariance property of the SW equations (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sw_cons"

\end_inset

) allows to reduce this sum of 2D problem to a sum of 1D local Riemann problems
 such that: 
\begin_inset Formula $\mathbf{F}_{e}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K_{e}}^{n},\mathbf{n}_{K}\right)=\mathbf{R}_{K}^{-1}\hat{\mathbf{F}_{e}}\left(\mathbf{\hat{U}}_{K}^{n},\mathbf{\hat{U}}_{K_{e}}^{n}\right)$
\end_inset

 with 
\begin_inset Formula $\mathbf{\hat{U}}_{K}^{n}=\mathbf{R}_{K}\mathbf{U}_{K}^{n}$
\end_inset

 where 
\begin_inset Formula $\mathbf{R}_{K}$
\end_inset

 is the rotation matrix, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Toro2001"
literal "true"

\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Note that for a computational efficiency in the code, given an edge 
\begin_inset Formula $e$
\end_inset

, the fluxes are computed in both ways: from left to right and from right
 to left.
 
\end_layout

\begin_layout Subsection
Low Froude scheme
\series bold

\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
The global numerical scheme is a combination of two schemes.
 The first one is the low Froude number asymptotic preserving and entropy
 dissipative scheme of Vila and al.
 and is used for the vast majority of the computational domain 
\begin_inset Note Note
status open

\begin_layout Plain Layout
SPECIFY PROPERTIES OF THE SCHEME
\end_layout

\end_inset

.
 The second one is a variant of the Rusanov scheme and is only used to stabilize
 solutions close to the boundary conditions and also to wet-dry cells 
\begin_inset Note Note
status open

\begin_layout Plain Layout
SPECIFY PROPETIES OF RUSANOV LIKE SHEME
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
In order to switch smoothly from the first scheme to the second one, a function
 of interpolation δ varying from 0 to 1 is a priori computed for all cells
 before applying the time step.
\end_layout

\begin_layout Standard
In practice, 
\begin_inset Formula $\delta_{k}$
\end_inset

 is set to 1 for cells with an edge at the physical boundary as for cells
 for which there is a neighbouring one with a dry state, and then going
 from cell to cell with common edges from a given number of (typically from
 3 to 5), the value goes to 0 linearly.
 Then for all edges is computed 
\begin_inset Formula $\delta_{e}=max(\delta_{K},\delta_{K_{e}})$
\end_inset

 giving the final interpolation value to compute the antisymmetric fluxes
 to preserve the convervation property of a Finite Volume scheme:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
For the low froude solver (from 
\series bold
couderc et al 
\series default
), we can express equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete"

\end_inset

 as follow :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
\begin{array}{c}
\left[\mathbf{F}_{e}\right]_{1,}={\displaystyle (1-\delta_{e})F_{e}^{n,*}+\delta_{e}F_{e}^{n,\#}}\\
\begin{array}{c}
\left[\mathbf{F}_{e}\right]_{2,3}={\displaystyle \left[(1-\delta_{e})\boldsymbol{G}_{e}^{n,*}+\delta_{e}\boldsymbol{G}_{e}^{n,\#}\right]}+h_{K}\left[(1-\delta_{e})\Phi_{e}^{n,*}+\delta_{e}\Phi_{e}^{n,\#}\right].\mathbf{n}_{e,K}\end{array}
\end{array}\end{array}\right.\label{eq:hllc-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $\left(F_{e}^{n,*},G_{e}^{n,*},\Phi_{e}^{n,*}\right)$
\end_inset

 is the low froude number asymptotic preserving and entropy disipative scheme
 of 
\series bold
vila and al, 
\series default
and 
\begin_inset Formula $\left(F_{e}^{n,\#},G_{e}^{n,\#},\Phi_{e}^{n,\#}\right)$
\end_inset

 is a rusanov like scheme and
\end_layout

\begin_layout Itemize
\begin_inset Formula $F_{e}$
\end_inset

 represent the flux for the first element of 
\begin_inset Formula $\mathbf{U}$
\end_inset

 / it accounts for mass conservation equation
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{G}_{e}=\left(G_{1,e},G_{2,e}\right)$
\end_inset

 represent the flux for the second and third elemets of 
\begin_inset Formula $\mathbf{U}$
\end_inset

 / it accounts for momentum conservation equation
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Phi_{e}$
\end_inset

 represent the 
\series bold
FLUX
\series default
 of potential (pressure +gravity)
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Paragraph

\series bold
Expression of the rusanov like scheme:
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $h_{k}^{n,R}$
\end_inset

 represent the water height of cell 
\begin_inset Formula $k$
\end_inset

, for rusanov-like scheme, using the famous hydrostatic reconstruction of
 Andusse and al.
 (see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Well-balanced-schemes-with"

\end_inset

 [
\series bold
Well-balanced schemes with wet/dry front treatment
\series default
] )
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Phi_{k}^{n,R}$
\end_inset

 represent the presure potential of cell 
\begin_inset Formula $k$
\end_inset

, for rusanov like scheme, accounting the reconstruction of the pressure
 potential to find the balance when water is below the bathymetry of a dry
 neighbouring cell implies :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\text{if}\,\,\:h_{k}^{n}+b_{k} & <b_{k_{e}}\text{\,\,\,and\,\,\,h_{k_{e}}}<h_{e}\text{\,,then}\,\,\,\Phi_{k_{e}}^{n,R}=\Phi_{k}^{n}\,,\text{else\,}\Phi_{k_{e}}^{n,R}=\Phi_{k_{e}}^{n}\\
\text{if\,}\,\:h_{k_{e}}^{n}+b_{k_{e}} & <b_{k}\text{\,\,\,and\,\,}\,h_{k}<h_{e}\,,\text{then}\,\,\,\Phi_{k}^{n,R}=\Phi_{k_{e}}^{n}\,,\text{else\,}\Phi_{k}^{n,R}=\Phi_{k}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\Phi_{k}^{n}$
\end_inset

represent the (pressure + gravity source term) in the homogeneous part timestep
 n on cell k : 
\begin_inset Formula $\Phi_{k}^{n}=g.(h_{k}^{n}+b_{k}^{n})$
\end_inset

.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Finaly we can define the rusanov-like scheme
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
F_{e}^{n,\#} & =\frac{1}{2}\left(h_{k}^{n,R}\boldsymbol{u}_{k}^{n}+h_{k_{e}}^{n,R}\boldsymbol{u}_{k_{e}}^{n}\right).\boldsymbol{n}_{e,K}-\lambda\left(h_{k_{e}}^{n,R}-h_{k}^{n,R}\right)\label{eq:rusanov like scheme}\\
\boldsymbol{G}_{e}^{n,\#} & =\frac{1}{2}\left(h_{k}^{n,R}\boldsymbol{u}_{k}^{n}\otimes\boldsymbol{u}_{k}^{n}+h_{k_{e}}^{n,R}\boldsymbol{u}_{k_{e}}^{n}\otimes\boldsymbol{u}_{k_{e}}^{n}\right).\boldsymbol{n}_{e,K}-\lambda\left(h_{k_{e}}^{n,R}\boldsymbol{u}_{k_{e}}^{n}-h_{k}^{n,R}\boldsymbol{u}_{k}^{n}\right)\nonumber \\
\Phi_{e}^{n,\#} & =\frac{1}{2}\left(\Phi_{k_{e}}^{n,R}+\Phi_{k}^{n,R}\right)\nonumber 
\end{align}

\end_inset

where 
\begin_inset Formula $\lambda=max(|\boldsymbol{u}_{k}^{n}.\boldsymbol{n}_{e,K}|+\sqrt{g\,h_{k}^{n,R}},|\boldsymbol{u}_{k_{e}}^{n}.\boldsymbol{n}_{e,K}|+\sqrt{g\,h_{k_{e}}^{n,R}})$
\end_inset

 is the wave speed (proposed in ????).
\end_layout

\begin_layout Paragraph

\series bold
Expression of the low froude number asymptotic preserving and entropy disipative
 scheme:
\end_layout

\begin_layout Itemize
\begin_inset Formula $m_{∂K}$
\end_inset

 represent the perimeter of cell 
\begin_inset Formula $k$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\gamma$
\end_inset

 represent weight given to 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
entropy dissipative part of scheme ?
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\alpha$
\end_inset

 represent weigth given to 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
entropy dissipative part of scheme?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
F_{e}^{n,*} & =\frac{1}{2}\left(h_{k}^{n}\boldsymbol{u}_{k}^{n}+h_{k_{e}}^{n}\boldsymbol{u}_{k_{e}}^{n}\right).\boldsymbol{n}_{e,K}-\frac{1}{8}\gamma\left(\frac{m_{\partial K}}{m_{K}}+\frac{m_{\partial K_{e}}}{m_{K_{e}}}\right)\left(\Phi_{k_{e}}^{n}-\Phi_{k}^{n}\right)\label{eq:entropy_scheme}\\
\boldsymbol{G}_{e}^{n,*} & =\boldsymbol{u}_{k}^{n}\left(F_{e}^{n,*}\right)^{+}+\boldsymbol{u}_{k_{e}}^{n}\left(F_{e}^{n,*}\right)^{-}\nonumber \\
\Phi_{e}^{n,*} & =\frac{1}{2}\left(\Phi_{k_{e}}^{n}+\Phi_{k}^{n}\right)-\frac{1}{4}\alpha g\left(\frac{m_{\partial K}}{m_{K}}+\frac{m_{\partial K_{e}}}{m_{K_{e}}}\right)\left(h_{k_{e}}^{n}\boldsymbol{u}_{k_{e}}^{n}-h_{k}^{n}\boldsymbol{u}_{k}^{n}\right)\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\left(F_{e}^{n,*}\right)^{+}=max(0,F_{e}^{n,*})$
\end_inset

 and 
\begin_inset Formula $\left(F_{e}^{n,*}\right)^{-}=min(0,F_{e}^{n,*})$
\end_inset

 
\end_layout

\begin_layout Paragraph

\series bold
\begin_inset Note Note
status collapsed

\begin_layout Paragraph

\series bold
Developped expression of equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:hllc-1"

\end_inset


\end_layout

\begin_layout Plain Layout
Equations
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rusanov like scheme"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:entropy_scheme"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be rewritten respectively as follow:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
F_{e}^{n,\#} & =\frac{1}{2}\left(h_{k}^{n,R}\left(u_{k}^{n}.n_{e,K,x}+v_{k}^{n}.n_{e,k,y}\right)+h_{k_{e}}^{n,R}\left(u_{k_{e}}^{n}.n_{e,K,x}+v_{k_{e}}^{n}.n_{e,K,y}\right)\right)-\lambda\left(h_{k_{e}}^{n,R}-h_{k}^{n,R}\right)\label{eq:developed_rusanov}\\
\left[G_{e}^{n,\#}\right]_{1} & =1/2*\left[h_{k}^{n,R}.\left(u_{k}^{n}²*n_{e,K,x}+u_{k}^{n}v_{k}^{n}*n_{e,K,y}\right)+h_{k_{e}}^{n,R}\left(u_{k_{e}}^{n}²*n_{e,K,x}+u_{k_{e}}^{n}v_{k_{e}}^{n}*n_{e,K,y}\right)\right]-\lambda\left[h_{k_{e}}^{n,R}.u_{k_{e}}^{n}-h_{k}^{n,R}u_{k}^{n}\right]\nonumber \\
\left[G_{,e}^{n,\#}\right]_{2} & =1/2*\left[h_{k}^{n,R}.\left(u_{k}^{n}v_{k}*n_{e,K,x}+v_{k}^{n}²*n_{e,K,y}\right)+h_{k_{e}}^{n,R}\left(u_{k_{e}}^{n}v_{k_{e}}^{n}*n_{e,K,x}+v_{k_{e}}^{n}²*n_{e,K,y}\right)\right]-\lambda\left[h_{k_{e}}^{n,R}.v_{k_{e}}^{n}-h_{k}^{n,R}v_{k}^{n}\right]\\
\Phi_{e}^{n,\#} & =\frac{1}{2}\left(\Phi_{k_{e}}^{n,R}+\Phi_{k}^{n,R}\right)\nonumber 
\end{align}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
F_{e}^{n,*}= & \frac{1}{2}\left(h_{k}^{n}\left(u_{k}^{n}.n_{e,k,x}+v_{k}^{n}.n_{e,k,y}\right)+h_{k_{e}}^{n}\left(u_{k_{e}}^{n}.n_{e,k,x}+v_{k_{e}}^{n}.n_{e,k,y}\right)\right)--\frac{1}{8}\gamma\left(\frac{m_{\partial K}}{m_{K}}+\frac{m_{\partial K_{e}}}{m_{K_{e}}}\right)\left(\Phi_{k_{e}}^{n}-\Phi_{k}^{n}\right)\label{eq:entropy_scheme-1}\\
\left[G_{e}^{n,*}\right]_{1}= & u_{k}^{n}max(0,F_{e}^{n,*})+u_{k_{e}}^{n}.min(0,F_{e}^{n,*})\nonumber \\
\left[G_{e}^{n,*}\right]_{2}= & v_{k}^{n}max(0,F_{e}^{n,*})+v_{k_{e}}^{n}.min(0,F_{e}^{n,*})\\
\Phi_{e}^{n,*}= & \frac{1}{2}\left(\Phi_{k_{e}}^{n}+\Phi_{k}^{n}\right)-\frac{1}{4}\alpha g\left(\frac{m_{\partial K}}{m_{K}}+\frac{m_{\partial K_{e}}}{m_{K_{e}}}\right)\left(\left(u_{k}^{n}.n_{e,k,x}+v_{k}^{n}.n_{e,k,y}\right)-\left(u_{k_{e}}^{n}.n_{e,k,x}+v_{k_{e}}^{n}.n_{e,k,y}\right)\right)\nonumber 
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The CFL-like condition for the time step 
\begin_inset Formula $\Delta t^{n}$
\end_inset

 is, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Vila2003"
literal "true"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Delta t^{n}=c\;\min_{K\in\Omega}{\displaystyle \left(\frac{2\;m_{K}}{m_{\partial K}\left(\left\Vert \mathbf{u}_{K}^{n}\right\Vert +\sqrt{gh_{K}^{n}}\right)}\right)}\label{eq:time-step-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with the constant 
\begin_inset Formula $c\in\left[0.5,0.8\right]$
\end_inset

 in practice.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Note that it is usual to introduce a small cut-off water depth 
\begin_inset Formula $h_{\epsilon}$
\end_inset

, if the velocity components vanishes in order to stabilize the numerical
 model or if round-off error generates a negative water depth.
 With the complete numerical scheme which is here developed, this cut-off
 can be set to a machine epsilon only.
\end_layout

\begin_layout Standard
The expressions above are next to be completed by the treatment of the source
 term 
\begin_inset Formula $S_{f}$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Well-balanced schemes with wet/dry front treatment 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Well-balanced-schemes-with"

\end_inset


\end_layout

\begin_layout Standard
The numerical scheme must preserve the fluid at rest property, that is the
 gradient of bathymetry 
\begin_inset Formula $\nabla z_{b}$
\end_inset

 must not provide 
\begin_inset Formula $\mathbf{u}^{n+1}\ne0$
\end_inset

 if 
\begin_inset Formula $\mathbf{u}^{n}=0$
\end_inset

.
 In the presence of topography gradients (in particular those perpendicular
 to the streamlines) the basic topography gradient 
\begin_inset Formula $\nabla z_{b}$
\end_inset

 discretization in the gravity source term 
\begin_inset Formula $\mathbf{S}_{g}\mathbf{\left(U\right)}$
\end_inset

 generates spurious velocities.
 There is no discrete balance between the hydrostatic pressure and the gravity
 source term anymore: 
\begin_inset Formula ${\displaystyle \nabla\left(gh^{^{2}}/2\right)\neq-gh\nabla z_{b}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The technique which is employed here is those presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2004,Audusse2005"
literal "true"

\end_inset

.
 It is based on the following change of variable.
 
\end_layout

\begin_layout Standard
From now, at left and right sides of edge 
\begin_inset Formula $e$
\end_inset

, the considered water depth values 
\begin_inset Formula $h_{\sqcap}^{*}$
\end_inset

 are those defined from the 
\begin_inset Quotes eld
\end_inset

reconstructed
\begin_inset Quotes erd
\end_inset

 topography 
\begin_inset Formula $z_{e}$
\end_inset

 as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
h_{\square}^{*}=\max\left(0,h_{\square}+z_{\square}-z_{e}\right)\\
\text{with}\quad\left\{ \begin{array}{c}
z_{\square}=\eta_{\square}-h_{\square}\\
z_{e}=\max\left(z_{K},z_{K_{e}}\right)
\end{array}\right.
\end{array}\label{eq:hydrostatic_h-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:typical-wb-wet/dry"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The conservative variable vector 
\begin_inset Formula $\mathbf{U}_{e,K}^{n}$
\end_inset

 in the semi-discrete scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete-muscl"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is now considered with the new variable:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{\square}^{*}=\begin{bmatrix}h_{\square}^{*}\\
h_{\square}^{*}\mathbf{u}
\end{bmatrix}\label{eq:hydrostatic_h_2-U-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note that this new variable 
\begin_inset Formula $h_{e,K}^{*}$
\end_inset

 depends on the bathymetry values 
\begin_inset Formula $z_{e,K}$
\end_inset

 and 
\begin_inset Formula $z_{e}$
\end_inset

.
\end_layout

\begin_layout Standard
s
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

As well as 
\begin_inset Formula $h_{k}^{*}$
\end_inset

, the potential 
\begin_inset Formula $\Phi_{k}^{n,R}$
\end_inset

 (accounting the reconstruction of the pressure potential to find the balance
 when water is below the bathymetry of a dry neighbouring cell implies :)
 is reconstructed as follow:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\text{if}\,\,\:h_{k}^{n}+b_{k} & <b_{k_{e}}\text{\,\,\,and\,\,\,h_{k_{e}}}<h_{e}\text{\,,then}\,\,\,\Phi_{k_{e}}^{n,R}=\Phi_{k}^{n}\,,\text{else\,}\Phi_{k_{e}}^{n,R}=\Phi_{k_{e}}^{n}\\
\text{if\,}\,\:h_{k_{e}}^{n}+b_{k_{e}} & <b_{k}\text{\,\,\,and\,\,}\,h_{k}<h_{e}\,,\text{then}\,\,\,\Phi_{k}^{n,R}=\Phi_{k_{e}}^{n}\,,\text{else\,}\Phi_{k}^{n,R}=\Phi_{k}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The resulting scheme reads: 
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{U}_{K}^{n+1}=\mathbf{U}_{K}^{n}-{\displaystyle \frac{\Delta t^{n}}{m_{K}}\sum_{e\in\partial K}m_{e}}\mathbf{F}_{e}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K_{e}}^{n},\mathbf{U}_{K}^{*n},\mathbf{U}_{K_{e}}^{*n};\delta_{e},\,\gamma\,,\,\alpha\,,\mathbf{n}_{K}\right)\end{array}\label{eq:semi-discrete-wb-order1-1}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Subsection
HLLC and MUSCL based schemes 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Pcpe de la technique Audusse et al.
\end_layout

\begin_layout Plain Layout
On ajoute un/des termes de flux (membre de gauche) pour re-equilibrer si
 besoin la discretisation water at rest.
\end_layout

\begin_layout Plain Layout
Cela est lourd mais marche TB notamment au front sec (h tends to 0) !
\end_layout

\begin_layout Plain Layout
Generalisation MUSCL 
\begin_inset Quotes eld
\end_inset

naturelle
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Technique de Couderc Durand Vila JCP non suivie ici.
\end_layout

\begin_layout Plain Layout
Le terme 
\begin_inset Formula $gh\nabla(h+z_{b})$
\end_inset

 est traite en non conservatif ; potentiel 
\begin_inset Formula $\Phi=(h+z_{b})$
\end_inset

 .
 Terme discretisé en centre.
\begin_inset Newline newline
\end_inset

Well-balanced (water at rest) ? Ordre 1: rien a faire.
 Ordre 2: idem.
 
\begin_inset Newline newline
\end_inset

On reste conservatif pour l'energie (alors que par construction pas pour
 le momentum).
\end_layout

\begin_layout Plain Layout
Technique moins compliquee qu'Audusse et al..
 Par contre on ne preserve plus la positivite lorsque h tend vers 0 (front
 sec) !...
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
First order scheme
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
The HLLC approximate Riemann solver is used.
 We have, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Toro2001"
literal "true"

\end_inset

 and references therein: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{c}
\begin{array}{c}
\left[\mathbf{\hat{F}}_{e}^{HLLC}\right]_{1,2}={\displaystyle \frac{s_{K_{e}}\left[\mathbf{F}(\hat{\mathbf{U}}_{K})\right]_{1,2}-s_{K}\left[\mathbf{F}(\hat{\mathbf{U}}_{K_{e}})\right]_{1,2}+s_{K}s_{K_{e}}(\left[\hat{\mathbf{U}}_{K_{e}}\right]_{1,2}-\left[\hat{\mathbf{U}}_{K}\right]_{1,2})}{s_{K_{e}}-s_{K}}}\end{array}\\
\left[\mathbf{\hat{F}}_{e}^{HLLC}\right]_{3}=\left[\mathbf{\hat{F}}_{e}^{HLLC}\right]_{1}\hat{v}*\quad\text{with}\quad\hat{v}*=\left\{ \begin{array}{c}
\hat{v}_{K}\quad\text{if}\quad s^{*}\geq0\\
\hat{v}_{K_{e}}\quad\text{if}\quad s^{*}<0
\end{array}\right.
\end{array}\right.\label{eq:hllc}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The wave speed expression are those proposed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Vila1986"
literal "true"

\end_inset

:
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
s_{K}=\min\left(0,\hat{u}_{K}-\sqrt{gh_{K}},\hat{u}_{K_{e}}-2\sqrt{gh_{K_{e}}}+\sqrt{gh_{K}}\right)\\
s_{K_{e}}=\max\left(0,\hat{u}_{K_{e}}+\sqrt{gh_{K_{e}}},\hat{u}_{K}+2\sqrt{gh_{K}}-\sqrt{gh_{K_{e}}}\right)
\end{array}\label{eq:hll_waves}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It has been demonstrated in in 
\begin_inset CommandInset citation
LatexCommand cite
key "Vila1986"
literal "true"

\end_inset

 that this insures 
\begin_inset Formula $L^{\infty}$
\end_inset

 stability, positivity and consistency with entropy condition under a CFL
 condition.
 
\end_layout

\begin_layout Standard
For the intermediate wave speed estimate, following 
\begin_inset CommandInset citation
LatexCommand cite
key "Toro2001"
literal "true"

\end_inset

 we set:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
s^{*}={\displaystyle \frac{s_{K}h_{K_{e}}\hat{u}_{K_{e}}-s_{K_{e}}h_{K}\hat{u}_{K}-s_{K}s_{K_{e}}(h_{K_{e}}-h_{K})}{h_{K_{e}}(\hat{u}_{K_{e}}-s_{K_{e}})-h_{K}(\hat{u}_{K}-s_{K})}}\label{eq:c_wave}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The CFL-like condition for the time step 
\begin_inset Formula $\Delta t^{n}$
\end_inset

 is, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Vila2003"
literal "true"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\Delta t^{n}=c\;\min_{K\in\Omega}{\displaystyle \left(\frac{2\;m_{K}}{m_{\partial K}\left(\left\Vert \mathbf{u}_{K}^{n}\right\Vert +\sqrt{gh_{K}^{n}}\right)}\right)}\label{eq:time-step}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with the constant 
\begin_inset Formula $c\in\left[0.5,0.8\right]$
\end_inset

 in practice.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
Note that it is usual to introduce a small cut-off water depth 
\begin_inset Formula $h_{\epsilon}$
\end_inset

, if the velocity components vanishes in order to stabilize the numerical
 model or if round-off error generates a negative water depth.
 With the complete numerical scheme which is here developed, this cut-off
 can be set to a machine epsilon only.
\end_layout

\begin_layout Standard
The expressions above are next to be completed by the treatment of the source
 term 
\begin_inset Formula $S_{f}$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Well-balanced schemes with wet/dry front treatment
\end_layout

\begin_layout Standard
The numerical scheme must preserve the fluid at rest property, that is the
 gradient of bathymetry 
\begin_inset Formula $\nabla z_{b}$
\end_inset

 must not provide 
\begin_inset Formula $\mathbf{u}^{n+1}\ne0$
\end_inset

 if 
\begin_inset Formula $\mathbf{u}^{n}=0$
\end_inset

.
 In the presence of topography gradients (in particular those perpendicular
 to the streamlines) the basic topography gradient 
\begin_inset Formula $\nabla z_{b}$
\end_inset

 discretization in the gravity source term 
\begin_inset Formula $\mathbf{S}_{g}\mathbf{\left(U\right)}$
\end_inset

 generates spurious velocities.
 There is no discrete balance between the hydrostatic pressure and the gravity
 source term anymore: 
\begin_inset Formula ${\displaystyle \nabla\left(gh^{^{2}}/2\right)\neq-gh\nabla z_{b}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The technique which is employed here is those presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2004,Audusse2005"
literal "true"

\end_inset

.
 It is based on the following change of variable.
 
\end_layout

\begin_layout Standard
From now, at left and right sides of edge 
\begin_inset Formula $e$
\end_inset

, the considered water depth values 
\begin_inset Formula $h_{\sqcap}^{*}$
\end_inset

 are those defined from the 
\begin_inset Quotes eld
\end_inset

reconstructed
\begin_inset Quotes erd
\end_inset

 topography 
\begin_inset Formula $z_{e}$
\end_inset

 as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
h_{\square}^{*}=\max\left(0,h_{\square}+z_{\square}-z_{e}\right)\\
\text{with}\quad\left\{ \begin{array}{c}
z_{\square}=\eta_{\square}-h_{\square}\\
z_{e}=\max\left(z_{K},z_{K_{e}}\right)
\end{array}\right.
\end{array}\label{eq:hydrostatic_h}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:typical-wb-wet/dry"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The conservative variable vector 
\begin_inset Formula $\mathbf{U}_{e,K}^{n}$
\end_inset

 in the semi-discrete scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete-muscl"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is now considered with the new variable:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{\square}^{*}=\begin{bmatrix}h_{\square}^{*}\\
h_{\square}^{*}\mathbf{u}
\end{bmatrix}\label{eq:hydrostatic_h_2-U}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note that this new variable 
\begin_inset Formula $h_{e,K}^{*}$
\end_inset

 depends on the bathymetry values 
\begin_inset Formula $z_{e,K}$
\end_inset

 and 
\begin_inset Formula $z_{e}$
\end_inset

.
\end_layout

\begin_layout Standard
The resulting scheme reads: 
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{U}_{K}^{n+1}=\mathbf{U}_{K}^{n}-{\displaystyle \frac{\Delta t^{n}}{m_{K}}\sum_{e\in\partial K}m_{e}}\left(\mathbf{F}_{e}(\mathbf{U}_{K}^{*n},\mathbf{U}_{K_{e}}^{*n},\mathbf{n}_{K})+\left.\mathbf{S}_{p}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)\right)\right.\end{array}\label{eq:semi-discrete-wb-order1}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
with
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{S}_{p}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)=\begin{bmatrix}0\\
{\displaystyle \frac{g}{2}}\left(\left(h_{K}^{n}\right)^{2}-\left(h_{K}^{n*}\right)^{2}\right)\mathbf{n}_{K}
\end{bmatrix}\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Pour les details et la comprehension, lire Audusse et al.
 !
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Rem.
 Les eqns discretes st pseudo-conservatives ; pas conservatives car non
 symetriques.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
Technique Couderc-Durand-Vila: le terme de gravite serait integre au 1er
 systeme dc non conservatif !...
 mais le schema n est alors plus positif lorsque h tend vers 0...
\end_layout

\begin_layout Plain Layout
On aurait la possibilite de mixer les deux ...
\end_layout

\begin_layout Plain Layout
Seule le formalisme de Audusse et al.
 preserve la masse en presence de fronts secs.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This provides a well-balanced (first order) scheme.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figs/wb-wet-dry.svg
	lyxscale 40
	width 40text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Typical situation of desired well-balanced property in presence of a wet/dry
 front.
 The WS elevation is here denoted by 
\begin_inset Formula $\eta$
\end_inset

.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:typical-wb-wet/dry"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Second order MUSCL scheme 
\end_layout

\begin_layout Standard
We here develop a second order scheme based on the concepts of reconstruction
 and slope limiting initially introduced by Van Leer in the late 70's.
 
\end_layout

\begin_layout Standard
A monoslope second order Monotonic Upwind Scheme for Conservation Laws (MUSCL)
 scheme is adopted, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Chevrier1993,Buffard2010"
literal "true"

\end_inset

.
 This consists to 
\begin_inset Quotes eld
\end_inset

reconstruct
\begin_inset Quotes erd
\end_inset

 
\emph on
locally linear fields by calculating a vectorial slope 
\begin_inset Formula $\left[\mathbf{\nabla}\mathbf{U}_{K}^{n}\right]_{i}$
\end_inset

 in each cell 
\begin_inset Formula $K$
\end_inset

, for each variable 
\begin_inset Formula $i$
\end_inset

.
 
\end_layout

\begin_layout Standard
The two 
\begin_inset Quotes eld
\end_inset

reconstructed
\begin_inset Quotes erd
\end_inset

 conservative variables vectors 
\begin_inset Formula $\mathbf{U}_{\nabla,K}^{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{\nabla,K_{e}}^{n}$
\end_inset

 at each side of edge 
\begin_inset Formula $e$
\end_inset

 read as:
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{U}_{\nabla,\square}^{n}=\mathbf{U}_{\square}^{n}+\mathbf{\nabla}\mathbf{U}_{\square}^{n}.\overrightarrow{\mathbf{\mathbf{x}_{\square}\mathbf{x}_{e}}}\end{array}\label{eq:muscl_recons_vector}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $\square=K$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

left cell
\begin_inset Quotes erd
\end_inset

) or 
\begin_inset Formula $K_{e}$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

right cell
\begin_inset Quotes erd
\end_inset

).
 For 
\begin_inset Formula $\square=K$
\end_inset

, this reads:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\begin{bmatrix}h_{\nabla,K}^{n}\\
h_{\nabla,K}^{n}\mathbf{u}_{\nabla,K}
\end{bmatrix}=\begin{bmatrix}h_{K}^{n}\\
h_{K}^{n}\mathbf{u}_{K}
\end{bmatrix}+\begin{bmatrix}\nabla h_{K}^{n}\\
\nabla(h_{K}^{n}\mathbf{u}_{K})
\end{bmatrix}.\overrightarrow{\mathbf{\mathbf{x}_{\square}\mathbf{x}_{e}}}\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
These two expressions replace 
\begin_inset Formula $\mathbf{U}_{K}^{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{K_{e}}^{n}$
\end_inset

 in the original first order semi-discrete scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete"

\end_inset

) to evaluate the numerical flux 
\begin_inset Formula $\mathbf{F}_{e}$
\end_inset

.
 
\end_layout

\begin_layout Standard
From these enriched linear conservative variable, the uncomplete basic FV
 scheme reads strictly the same:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{K}^{n+1}=\mathbf{U}_{K}^{n}-{\displaystyle \frac{\Delta t^{n}}{m_{K}}\sum_{e\in\partial K}m_{e}}\mathbf{F}_{e}\left(\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K_{e}}^{n},\mathbf{n}_{K}\right)\label{eq:semi-discrete-muscl}
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph
Computation of the vectorial slopes
\end_layout

\begin_layout Standard
With a such linear reconstruction, one can expect a scheme with a second-order
 accuracy in space (for regular solutions only).
 To this end, a least square method is employed to compute the vectorial
 slopes for each 
\emph on
primitive
\emph default
 variable denoted by 
\begin_inset Formula $\mathbf{W}$
\end_inset

 .
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{W}=\left[h,u,v\right]^{T}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Let us defined the sum of squares for each 
\begin_inset Formula $i$
\end_inset

, 
\begin_inset Formula $i=1,\dots,3$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
E_{i}\left(\left[\widetilde{\mathbf{\nabla}\mathbf{W}_{K}^{n}}\right]_{i}\right)={\displaystyle \sum_{e\in\partial K}\left(\left[\mathbf{W}_{K_{e}}^{n}\right]_{i}-\left(\left[\mathbf{W}_{K}^{n}\right]_{i}+\left[\mathbf{\nabla}\mathbf{W}_{K}^{n}\right]_{i}.\overrightarrow{\mathbf{x}_{K}\mathbf{x}_{K_{e}}}\right)\right)^{2}}\end{array}\label{eq:ls_muscl}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Each term 
\begin_inset Formula $E_{i}\left(\left[\widetilde{\mathbf{\nabla}\mathbf{W}_{K}^{n}}\right]_{i}\right)$
\end_inset

 is minimized (as the solution of simple 
\begin_inset Formula $2\times2$
\end_inset

 linear systems).
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
This method represents a good alternative among others to find the hyperplane
 
\begin_inset CommandInset citation
LatexCommand cite
key "Chevrier1993,Haider2009"
literal "true"

\end_inset

 because of its accuracy and robustness independently to the number of neighbour
s.
 This is an important property as it will be shown later with the present
 wet/dry front treatment.
\end_layout

\begin_layout Paragraph
Limitation of the vectorial slopes
\end_layout

\begin_layout Standard
In order to prevent large numerical instabilities, the computed vectorial
 slopes above need to be limited.
\end_layout

\begin_layout Standard

\series bold
Maximum Principle (MP) limiter
\end_layout

\begin_layout Standard
A first method consists to apply the Maximum Principle (MP) to the two edge
 (unlimited) reconstructed primitive variables calculated from (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:muscl_recons_vector"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ls_muscl"

\end_inset

).
 
\end_layout

\begin_layout Standard
Then the limited reconstructed variables 
\begin_inset Formula $\mathbf{W}_{\nabla,K}^{n}$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbf{W}_{\nabla,K_{e}}^{n}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 are defined as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\min\left(\mathbf{W}_{K}^{n},\mathbf{W}_{K_{e}}^{n}\right)\leq\mathbf{W}_{\nabla,K}^{n}\mbox{ and }\mathbf{W}_{\nabla,K_{e}}^{n}\leq\max\left(\mathbf{W}_{K}^{n},\mathbf{W}_{K_{e}}^{n}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This is the so-called the MP limiter.
\end_layout

\begin_layout Standard
In practice, this method generates moderate oscillations at solution singulariti
es, whereas diffusion is minimized comparatively to other classic limiters
 like Minmod or Van Albada, see also e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2005,Nikolos2009,Delis2011,Delis2013"
literal "true"

\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
It is worth to point out that generation of new extremas in presence of
\shape italic
\emph on
 wet/dry fronts
\shape default
\emph default
 can break the mass conservation, and in this case
\emph on
 the scheme is no longer positive.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
A first solution to this issue is to handle 
\begin_inset Quotes eld
\end_inset

by hand
\begin_inset Quotes erd
\end_inset

 the mass conservation at the end of each time step.
 The mass artificially added cutting-off to zero an eventual negative water
 depth is removed proportionally to neighboring wet cells.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Barth limiter: NOT USED IN CURRENT VERSION
\end_layout

\begin_layout Plain Layout
An alternative solution is the use of the 
\emph on
Barth limiter
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Barth2003"
literal "true"

\end_inset

 for the water depth 
\begin_inset Formula $h$
\end_inset

.
\end_layout

\begin_layout Plain Layout
This consists to write:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
{\displaystyle \left[\mathbf{\nabla}\mathbf{W}_{K}^{n}\right]_{i}=\min_{e\in\partial K}\left(1,\left[\phi_{K,e}\right]_{i}\right)\left[\widetilde{\mathbf{\nabla}\mathbf{W}_{K}^{n}}\right]_{i}}\\
\\
{\displaystyle \left[\phi_{K,e}\right]_{i}=}\left\{ \begin{array}{cl}
0 & \ \text{if}\ {\displaystyle \left(\left[\mathbf{W}_{K_{e}}^{n}\right]_{i}-\left[\mathbf{W}_{K}^{n}\right]_{i}\right)}{\displaystyle \left[\mathbf{\nabla}\mathbf{W}_{K}^{n}\right]_{i}.\mathbf{x}_{K}\mathbf{x}_{e}<0}\\
{\displaystyle \frac{{\displaystyle \left[\mathbf{W}_{K_{e}}^{n}\right]_{i}-\left[\mathbf{W}_{K}^{n}\right]_{i}}}{\left[\mathbf{\nabla}\mathbf{W}_{K}^{n}\right]_{i}.\mathbf{x}_{K}\mathbf{x}_{e}}} & \ \text{if not}
\end{array}\right.
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
The reconstructed conservative variables vectors 
\begin_inset Formula $\mathbf{U}_{K}^{n}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}_{K_{e}}^{n}$
\end_inset

 are next obtained by a simple multiplication.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Well-balanced schemes with wet/dry front treatment
\end_layout

\begin_layout Standard
Following 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2004,Audusse2005"
literal "true"

\end_inset

, this issue is solved by evaluating the vectorial slope for the water surface
 elevation 
\begin_inset Formula $H$
\end_inset

 rather than for the water height 
\begin_inset Formula $h$
\end_inset

.
 A new vectorial slope for the variable 
\begin_inset Formula $\eta=h+z$
\end_inset

 is first calculated in addition to the primitive variables ones.
 
\end_layout

\begin_layout Standard
As previously, the so-called hydrostatic reconstructed water depth 
\begin_inset Formula $h_{e,K}^{*}$
\end_inset

 is defined from the reconstructed topography 
\begin_inset Formula $z_{e}$
\end_inset

 at edge 
\begin_inset Formula $e$
\end_inset

 as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
h_{\nabla,\square}^{*}=\max\left(0,h_{\nabla,\square}+z_{\square}-z_{e}\right)\\
\text{with}\quad\left\{ \begin{array}{c}
z_{\square}=\eta_{\square}-h_{\nabla,\square}\\
z_{e}=\max\left(z_{K},z_{K_{e}}\right)
\end{array}\right.
\end{array}\label{eq:hydrostatic_h_nabla}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $\square=K$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

left cell
\begin_inset Quotes erd
\end_inset

) or 
\begin_inset Formula $K_{e}$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

right cell
\begin_inset Quotes erd
\end_inset

).
 See Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:typical-wb-wet/dry"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
The conservative variable vector 
\begin_inset Formula $\mathbf{U}_{K}^{n}$
\end_inset

 in the semi-discrete scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete-muscl"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is now considered with the new variable:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{\nabla,\square}^{*}=\begin{bmatrix}h_{\nabla,\square}^{*}\\
(h^{*}\mathbf{u})_{\nabla,\square}
\end{bmatrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Let us write the 
\emph on
second order scheme in space only
\emph default
 while considering the basic explicit Euler time scheme for sake of clarity.
 This reads:
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{K}^{n+1}=\mathbf{U}_{K}^{n}-{\displaystyle \frac{\Delta t^{n}}{m_{K}}\sum_{e\in\partial K}m_{e}}\mathbf{L}_{e}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K}^{*n};\mathbf{U}_{\nabla,K_{e}}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)\label{eq:semi-discrete-wb-order2}
\end{equation}

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{L}_{e}\equiv\mathbf{L}_{e}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K}^{*n};\mathbf{U}_{\nabla,K_{e}}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)=\mathbf{F}_{e}\left(\mathbf{U}_{\nabla,K}^{*n};\mathbf{U}_{\nabla,K_{e}}^{*n};\mathbf{n}_{K}\right)+\mathbf{S}_{p}\left(\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)+\mathbf{S}_{g}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{\nabla,K}^{n},z_{K},\mathbf{n}_{K}\right)\label{def:Le}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
with
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{S}_{p}\left(\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)=\begin{bmatrix}0\\
{\displaystyle \frac{g}{2}}\left(\left(h_{\nabla,K}^{n}\right)^{2}-\left(h_{K}^{n*}\right)^{2}\right)\mathbf{n}_{K}
\end{bmatrix}\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
and the gravitational uncentered corrective term: 
\end_layout

\begin_layout Plain Layout

\series bold
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\mathbf{S}_{g}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{\nabla,K}^{n};z_{K},\mathbf{n}_{K}\right)=\begin{bmatrix}0\\
{\displaystyle \frac{g}{2}}\left(h_{\nabla,K}^{n}+h_{K}^{n}\right)\left(z_{\nabla,K}-z_{K}\right)\mathbf{n}_{K}
\end{bmatrix}\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout

\series bold
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $\mathbf{S}_{g}$
\end_inset

 term emerges as a corrective term for the 2nd order bathymetry reconstruction.
\end_layout

\begin_layout Plain Layout
To understand: read Audusse et al.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
However, numerical experiments show that this scheme is not stable at wet/dry
 fronts perpendicular to the flow streamlines.
\end_layout

\begin_layout Subsubsection*
\begin_inset Note Note
status open

\begin_layout Subsubsection*
Additional treatments to stabilize at wet-dry fronts (second order case)
\end_layout

\begin_layout Plain Layout
USED IN CURRENT VERSION ???? A-PRIORI NO ! ....
\end_layout

\begin_layout Plain Layout
*
\end_layout

\begin_layout Plain Layout
Additional treatments are introduced to stabilize in all cases and for any
 limiter (MP or Barth one), providing a second order well-balanced scheme
 even in presence of wet-dry fronts.
\end_layout

\begin_layout Plain Layout
Firstly, all vectorial slopes are enforced to zero in dry cells.
 In practice, this consists to apply a mask.
 
\end_layout

\begin_layout Plain Layout
Secondly, these same dry cells are not taken into account in the least square
 formulation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ls_muscl"

\end_inset

) to predict the vectorial slope 
\begin_inset Formula $\nabla\eta^{n}$
\end_inset

.
 Indeed, we set:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\left[\mathbf{\nabla}\mathbf{U}_{K}^{n}\right]_{i}=\mathbf{0}\quad\text{if}\quad h_{K}=0\\
\\
E\left(\mathbf{\nabla}\eta_{K}^{n}\right)=\underset{e\in\left(\partial K\backslash h_{K_{e}}=0\right)}{\sum}\left(\mathbf{\eta}_{K_{e}}^{n}-\left(\eta_{K}^{n}+\mathbf{\nabla}\eta_{K}^{n}.\mathbf{x}_{K}\mathbf{x}_{K_{e}}\right)\right)^{2}
\end{array}\label{eq:wb-wet/dry}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
These conditions are related to the typical situation in Fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:typical-wb-wet/dry"
plural "false"
caps "false"
noprefix "false"

\end_inset

) where the well-balanced property is desired with presence of a wet/dry
 front because the water surface level 
\begin_inset Formula $\eta$
\end_inset

 is constant around the cell 
\begin_inset Formula $K$
\end_inset

.
 
\end_layout

\begin_layout Plain Layout
The dry cell 
\begin_inset Formula $K_{e}$
\end_inset

 has a bottom topography 
\begin_inset Formula $z_{K_{e}}$
\end_inset

 upper than the neibgboring wet cell 
\begin_inset Formula $K$
\end_inset

 water surface level 
\begin_inset Formula $\eta_{K}$
\end_inset

, the fluxes must be enforced to zero at the edge 
\begin_inset Formula $e$
\end_inset

 between the two cells (water cannot 
\begin_inset Quotes eld
\end_inset

climb
\begin_inset Quotes erd
\end_inset

 in this situation) and the well-balanced property must be verified in the
 cell 
\begin_inset Formula $K$
\end_inset

.
\end_layout

\begin_layout Plain Layout
Making the hypothesis that the normal velocity 
\begin_inset Formula $\hat{u}_{K}$
\end_inset

 is not necessary zero, a simple way to enforce 
\begin_inset Formula $\mathbf{F}_{e}\left(\mathbf{U}_{\nabla,K}^{*n},\mathbf{U}_{\nabla,K_{e}}^{*n},\mathbf{n}_{K}\right)$
\end_inset

 in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete-muscl"
plural "false"
caps "false"
noprefix "false"

\end_inset

) to be zero is for the reconstructed hydrostatic water depths 
\begin_inset Formula $h_{K}^{*}$
\end_inset

 and 
\begin_inset Formula $h_{K_{e}}^{*}$
\end_inset

 to be always zero.
\end_layout

\begin_layout Plain Layout
Remark that it is always true for the first order scheme since:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $z_{e}=\max\left(z_{K},z_{K_{e}}\right)=z_{K_{e}}>h_{K}+z_{K}$
\end_inset

, 
\begin_inset Formula $h_{e,K}^{*}=\max\left(0,h_{K}+z_{K}-z_{e}\right)=0$
\end_inset

 and 
\begin_inset Formula $h_{e,K_{e}}^{*}=\max\left(0,h_{K_{e}}+z_{K_{e}}-z_{e}\right)=0$
\end_inset

.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
On other side, a key-point in the second order well-balanced method proposed
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2004,Audusse2005"
literal "true"

\end_inset

 is that the vectorial slope for the variable 
\begin_inset Formula $\eta=h+z$
\end_inset

 must be zero to find the well-balanced property in a cell 
\begin_inset Formula $K$
\end_inset

.
 The variable 
\begin_inset Formula $\eta$
\end_inset

 must be constant in all neighboring cells of a wet cell which is not true
 in our typical case, Fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:typical-wb-wet/dry"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Plain Layout
So, in order to find a zero vectorial slope for the variable 
\begin_inset Formula $\eta$
\end_inset

 in the cell 
\begin_inset Formula $K$
\end_inset

, the dry cell 
\begin_inset Formula $K_{e}$
\end_inset

 is not taken into account in the least square method (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ls_muscl"

\end_inset

).
\end_layout

\begin_layout Plain Layout
Now, a consequence is that 
\begin_inset Formula $\eta_{e,K}=h_{K}+z_{K}<\eta_{e,K_{e}}=z_{e,K_{e}}$
\end_inset

 implying that 
\begin_inset Formula $z_{e}=\max\left(z_{e,K},z_{e,K_{e}}\right)=z_{e,K_{e}}$
\end_inset

 and concluded that it is always find that 
\begin_inset Formula $h_{e,K}^{*}=\max\left(0,\eta_{e,K}-z_{e}\right)=0$
\end_inset

.
\end_layout

\begin_layout Plain Layout
Since all vectorial slopes are enforced to zero in dry cells, it is obvious
 that we have also 
\begin_inset Formula $h_{e,K_{e}}^{*}=0$
\end_inset

.
 
\end_layout

\begin_layout Plain Layout
The sum of the non negative components of the two sources terms 
\begin_inset Formula $\mathbf{S}_{g}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{e,K}^{*n},\mathbf{n}_{e,K}\right)$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}_{g}^{c}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{e,K}^{*n},z_{K},z_{e,K},\mathbf{n}_{e,K}\right)$
\end_inset

 is reduce to 
\begin_inset Formula $-{\displaystyle \frac{g}{2}h_{K}^{2}\mathbf{n}_{e,K}}$
\end_inset

 because 
\begin_inset Formula $z_{e,K}-z_{K}=h_{K}-h_{e,K}$
\end_inset

.
 This does not change the demonstration in 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2005"
literal "true"

\end_inset

 to find the well-balanced property in the cell 
\begin_inset Formula $K$
\end_inset

 (that use the geometrical property 
\begin_inset Formula ${\displaystyle \sum_{e\in\partial K}}m_{e}\mathbf{n}_{e,K}=0$
\end_inset

).
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
In conclusion, the additional requirements (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:wb-wet/dry"

\end_inset

) to the original scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-discrete-muscl"
plural "false"
caps "false"
noprefix "false"

\end_inset

) are sufficient to obtain the well-balanced property in presence of wet/dry
 interfaces without any consideration on limitation (like it is classically
 the case in the literature).
\end_layout

\begin_layout Plain Layout
Moreover it does not change the global scheme at wet/dry fronts because
 the predicted vectorial slopes only are manipulated.
\end_layout

\begin_layout Plain Layout
In the end, the scheme 
\begin_inset Quotes eld
\end_inset

falls at worst
\begin_inset Quotes erd
\end_inset

 at the first order in the cells with a neigboring dry cell.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Splitting and friction source term
\end_layout

\begin_layout Standard
The friction source term is taken into account in the complete SW system
 by deriving a splitting method.
 This may be viewed as prediction-correction time scheme too.
 We refer to 
\begin_inset CommandInset citation
LatexCommand cite
key "Toro2001"
literal "true"

\end_inset

 Chapter 12.
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\emph on
We denote here by 
\begin_inset Formula $\bar{\mathbf{U}}_{K}^{n+1}$
\end_inset

 the FV solution at time 
\begin_inset Formula $t^{n+1}$
\end_inset

 of the (well-balanced) scheme, either first or second order, of the SW
 system with the gravitational term 
\begin_inset Formula $\mathbf{S}_{g}$
\end_inset

 but without the friction term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

.
 
\emph default

\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

The notation 
\begin_inset Formula $\bar{}$
\end_inset

 should not be mixed up with depth-averaging...
\end_layout

\begin_layout Standard
Recall that we denote: 
\begin_inset Formula $\mathbf{U}=\left(h,h\boldsymbol{u}\right)^{T}$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Prediction- correction scheme / splitting scheme 
\end_layout

\begin_layout Standard
At each time step, from 
\begin_inset Formula $n$
\end_inset

 to 
\begin_inset Formula $n+1$
\end_inset

, 
\end_layout

\begin_layout Itemize

\series bold
Step 1: 
\series default
computation of 
\begin_inset Formula $\bar{\mathbf{U}}^{n+1}$
\end_inset

, solution of the conservative SW system, i.e.
 the SW system 
\emph on
without 
\begin_inset Formula $S_{f}$
\end_inset


\emph default
, i.e.
 the FV solution of the following system: 
\begin_inset Formula 
\begin{equation}
\partial_{t}\boldsymbol{U}+\partial_{x}\text{\bF}\left(\boldsymbol{U}\right)+\partial_{y}\bG\left(\boldsymbol{U}\right)=\mathbf{S}_{p}\left(\boldsymbol{U}\right)\label{eq:substep_SWE_with_grav_term}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Recall that the discrete form of Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:substep_SWE_with_grav_term"
plural "false"
caps "false"
noprefix "false"

\end_inset

 reads: for all 
\begin_inset Formula $K$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
First order case:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\mathbf{\bar{U}}_{K}^{n+1} & =\mathbf{U}_{K}^{n}-\Delta t^{n}\left[{\displaystyle \frac{1}{m_{K}}\sum_{e\in\partial K}m_{e}}\left(\mathbf{F}_{e}(\mathbf{U}_{K}^{*n},\mathbf{U}_{K_{e}}^{*n},\mathbf{n}_{K})+\left.\mathbf{S}_{p}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)\right)\right.\right]\label{eq:semi-implicit-friction-1}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
Second order case:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align}
\mathbf{\bar{U}}_{K}^{n+1} & =\mathbf{U}_{K}^{n}-\Delta t^{n}\left[{\displaystyle \frac{1}{m_{K}}\sum_{e\in\partial K}m_{e}}\left(\mathbf{F}_{e}\left(\mathbf{U}_{\nabla,K}^{*n};\mathbf{U}_{\nabla,K_{e}}^{*n};\mathbf{n}_{K}\right)+\mathbf{S}_{p}\left(\mathbf{U}_{\nabla,K}^{n},\mathbf{U}_{\nabla,K}^{*n};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)+\mathbf{S}_{g}\left(\mathbf{U}_{K}^{n},\mathbf{U}_{\nabla,K}^{n},z_{K},\mathbf{n}_{K}\right)\right)\right]\label{eq:semi-implicit-friction}
\end{align}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Step 2: 
\series default
given the 
\begin_inset Quotes erd
\end_inset

predicted value
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\bar{\mathbf{U}}^{n+1}$
\end_inset

, compute 
\begin_inset Formula $\mathbf{U}^{n+1}$
\end_inset

 solution of:
\begin_inset Formula 
\begin{equation}
\partial_{t}\boldsymbol{\mathbf{U}}=\mathbf{S}_{f}\left(\mathbf{U}\right)\label{eq:substep_friction_term}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\series bold
Expression of 
\begin_inset Formula $\mathbf{U^{n+1}}$
\end_inset

 in the first order case
\end_layout

\begin_layout Standard
General schemes (explicit, implicit or semi-implicit ones) including the
 friction source term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 in the discretization of the model (Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sw_cons"

\end_inset

) can be written as: for all 
\begin_inset Formula $K$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mathbf{U}_{K}^{n+1} & =\mathbf{\bar{U}}_{K}^{n+1}+\Delta_{t}^{n}\mathbf{S}_{f}\left(\mathbf{\bar{U}}_{K}^{n+1},\mathbf{\bar{U}}_{K_{e}}^{n+1}\right)\label{eq:semi-implicit-friction-1-1}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Note that this splitting scheme is consistent at first order in 
\begin_inset Formula $\Delta t$
\end_inset

 with the complete SWE.
 Splitting scheme second order in time is possible; it is not detailed later.
 
\end_layout

\begin_layout Standard
In the case of the Manning-Strickler law, the friction term reads: 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\mathbf{S}_{f}=-gn^{2}\left[\begin{array}{c}
0\\
\frac{\left|\bar{\boldsymbol{u}}\right|}{h^{\frac{1}{3}}}\boldsymbol{\bar{u}}
\end{array}\right]$
\end_inset

.
 
\end_layout

\begin_layout Standard
Therefore the equation to be solved (Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:substep_friction_term"
plural "false"
caps "false"
noprefix "false"

\end_inset

) reads:
\begin_inset Formula 
\begin{equation}
\partial_{t}\left(\begin{array}{c}
h\\
h\boldsymbol{\bar{u}}
\end{array}\right)=-gn^{2}\left(\begin{array}{c}
0\\
\frac{\left|\bar{\boldsymbol{u}}\right|}{h^{\frac{1}{3}}}\boldsymbol{\bar{u}}
\end{array}\right)\label{eq:7}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since the friction source term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 is zero in the mass conservation equation, we remark that 
\begin_inset Formula $h^{n+1}=\bar{h}^{n+1}$
\end_inset

.
\end_layout

\begin_layout Standard
As a consequence, we consider the non-zero momentum component only:
\begin_inset Formula 
\begin{equation}
\partial_{t}\left(h\boldsymbol{\bar{u}}\right)=-gn^{2}\frac{\left|\bar{\boldsymbol{u}}\right|}{h^{\frac{1}{3}}}\boldsymbol{\bar{u}}\label{eq:8}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Let us consider 
\emph on
the implicit scheme
\emph default
 (implicit in 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

):
\begin_inset Formula 
\begin{equation}
\frac{h^{n+1}\boldsymbol{u}^{n+1}-h^{n+1}\bar{\boldsymbol{u}}^{n+1}}{\Delta t^{n}}=-gn^{2}\frac{\left|\boldsymbol{u}^{n+1}\right|\boldsymbol{u}^{n+1}}{\left(h^{n+1}\right)^{\frac{1}{3}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
It follows that:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
h^{n}\boldsymbol{u}^{n+1}-h^{n}\bar{\boldsymbol{u}}^{n+1}+\frac{\Delta t^{n}gn^{2}\left|\boldsymbol{u}^{n+1}\right|\boldsymbol{u}^{n+1}}{\left(h^{n}\right)^{\frac{1}{3}}}=0
\end{equation}

\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Observe that numerical instabilities may appear at wet/dry fronts due to
 the presence of 
\begin_inset Formula $h^{1/3}$
\end_inset

 at denominator in 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This implies that:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left|\boldsymbol{u}^{n+1}\right|\boldsymbol{u}^{n+1}+\frac{\left(h^{n+1}\right)^{\frac{4}{3}}}{\Delta t^{n}gn^{2}}\left(\boldsymbol{u}^{n+1}-\bar{\boldsymbol{u}}^{n+1}\right)=0
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Let us set 
\begin_inset Formula $c=\frac{\left(h^{n+1}\right)^{\frac{4}{3}}}{\Delta t^{n}gn^{2}}$
\end_inset

.
 
\begin_inset Formula $c\geq0$
\end_inset

.
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\left|\boldsymbol{u}^{n+1}\right|\boldsymbol{u}^{n+1}+c\boldsymbol{u}^{n+1}=c\bar{\boldsymbol{u}}^{n+1}$
\end_inset

.
 Therefore for non vanishing velocities, it exists 
\begin_inset Formula $\alpha\in\left]0,1\right]$
\end_inset

 such that: 
\begin_inset Formula $\boldsymbol{u}^{n+1}=\alpha\bar{\boldsymbol{u}}^{n+1}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Adopting these notations, we obtain: 
\begin_inset Formula $\left|\bar{\boldsymbol{u}}^{n+1}\right|\bar{\boldsymbol{u}}^{n+1}\alpha^{2}+c\bar{\boldsymbol{u}}^{n+1}\alpha-c\bar{\boldsymbol{u}}^{n+1}=0$
\end_inset

.
 This simplifies to:
\begin_inset Formula 
\begin{equation}
\left|\bar{\boldsymbol{u}}^{n+1}\right|\alpha^{2}+c\thinspace\alpha-c=0
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $\alpha\geq0$
\end_inset

, the root of this quadratic equation reads:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\alpha=\frac{-c+\sqrt{c^{2}+4c\left|\bar{\boldsymbol{u}}^{n+1}\right|}}{2\left|\bar{\boldsymbol{u}}^{n+1}\right|}\label{eq:alpha}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Let us define the function 
\begin_inset Formula $\varepsilon=\frac{1}{c}\left|\bar{\mathbf{u}}^{n+1}\right|=\Delta t^{n}gn^{2}\frac{\left|\bar{\mathbf{u}}^{n+1}\right|}{\left(h^{n+1}\right)^{4/3}}$
\end_inset

.
\end_layout

\begin_layout Standard
Observe that 
\begin_inset Formula $\varepsilon=O\left(\Delta t^{n}\right)$
\end_inset

, also 
\begin_inset Formula $\varepsilon=O\left(\frac{\left|\bar{\mathbf{u}}^{n+1}\right|}{\left(h^{n+1}\right)^{4/3}}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
By adopting this notation, the expression (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:alpha"
plural "false"
caps "false"
noprefix "false"

\end_inset

) of 
\begin_inset Formula $\alpha$
\end_inset

 reads: 
\begin_inset Formula $\alpha=\frac{\sqrt{1+4\epsilon}-1}{2\epsilon}$
\end_inset

.
 
\end_layout

\begin_layout Standard
After some rearrangements
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula 
\begin{align*}
\frac{\sqrt{1+4\epsilon}-1}{2\epsilon} & =\left(\frac{\sqrt{1+4\varepsilon}+1}{1+\sqrt{1+4\varepsilon}}\right)\left(\frac{\sqrt{1+4\epsilon}-1}{2\epsilon}\right)\\
 & =\frac{1+4\epsilon-1}{2\epsilon\left(1+\sqrt{1+4\varepsilon}\right)}\\
 & =\frac{2}{1+\sqrt{1+4\varepsilon}}
\end{align*}

\end_inset


\end_layout

\end_inset

, we obtain:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\alpha & =\frac{2}{1+\sqrt{1+4\varepsilon}}\label{eq:alpha_epsilon}
\end{align}

\end_inset

At 1st order in 
\begin_inset Formula $\epsilon$
\end_inset

, we get
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Formula $(1+\epsilon)^{\beta}\sim1+\beta\epsilon$
\end_inset

 ; 
\begin_inset Formula $1/(1+\epsilon)\sim1-\epsilon$
\end_inset


\end_layout

\end_inset

: 
\begin_inset Formula $\alpha\sim\left({\displaystyle \frac{1}{1+\epsilon/4}}\right)\sim1-\epsilon/4$
\end_inset

.
\end_layout

\begin_layout Standard
Finally, we obtain:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{u}^{n+1}=\left({\displaystyle \frac{2\left(h^{n+1}\right)^{2/3}}{\left(h^{n+1}\right)^{2/3}+\sqrt{\left(h^{n+1}\right)^{\frac{4}{3}}+4\Delta t^{n}gn^{2}\left|\bar{\mathbf{u}}^{n+1}\right|}}}\right)\bar{\boldsymbol{u}}^{n+1}\label{eq:u_n+1_final}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The final expression of the first order scheme is:
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{K}^{n+1}=\left(\begin{array}{c}
h^{n+1}\\
h^{n+1}\boldsymbol{u}^{n+1}
\end{array}\right)=\begin{bmatrix}\begin{array}{c}
\bar{h}^{n+1}\\
h^{n+1}\bar{\mathbf{u}}^{n+1}\left({\displaystyle \frac{2\left(\bar{h}^{n+1}\right)^{2/3}}{\left(\bar{h}^{n+1}\right)^{2/3}+\sqrt{\left(\bar{h}^{n+1}\right)^{\frac{4}{3}}+4\Delta t^{n}gn^{2}\left|\bar{\mathbf{u}}^{n+1}\right|}}}\right)
\end{array}\end{bmatrix}\label{eq:Un+1}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Un+1"

\end_inset

) ensures the property 
\begin_inset Formula $q^{n}q^{n+1}\geq0$
\end_inset

 without limitating value to stabilize the method at wet-dry front.
 
\series bold

\begin_inset Newline newline
\end_inset

Proof ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
With 
\begin_inset Formula $\left|\bar{\mathbf{u}}^{n+1}\right|$
\end_inset

 the solution of Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:semi-implicit-friction-1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 .
 
\end_layout

\begin_layout Standard
This is the first order scheme implemented into the code.
\end_layout

\begin_layout Standard
Note that the friction coefficient 
\begin_inset Formula $n$
\end_inset

 may depend on the depth 
\begin_inset Formula $h$
\end_inset

 like e.g.
 
\begin_inset Formula $n\equiv n(\alpha,\beta;h)=\alpha h^{\beta}$
\end_inset

.
\end_layout

\begin_layout Subsubsection*

\series bold
Expression of 
\begin_inset Formula $\mathbf{U^{n+1}}$
\end_inset

 in the 
\series default
second order case 
\end_layout

\begin_layout Standard
In order to obtain a globally second order scheme, a higher-order time stepping
 scheme is needed.
 
\end_layout

\begin_layout Standard
A first possibility would be to replace the explicit splitted step for 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 in the classical second order SSP-RK2 method, see e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gottlieb2001"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
This time splitting strategy is stable and preserves positivity, however
 it is first order only !...
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
In order to derive an 
\emph on
actual second order scheme
\emph default
 with an full implicit discretization of the source term, Pareschi and Russo
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Pareschi2005"
literal "true"

\end_inset

 derive an IMplicit-EXplicit (IMEX) Runge-Kutta method for hyperbolic conservati
on laws with stiff relaxation terms.
 
\end_layout

\begin_layout Standard
Here we consider the scheme named IMEX-SSP(3,2,2).
 This provides the following scheme:
\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\begin{array}{lcll}
\mathbf{U}_{K}^{(1)} & = & \mathbf{U}_{K}^{n} & +{\displaystyle \frac{\Delta t^{n}}{2}}\mathbf{S}_{f}(\mathbf{U}_{K}^{(1)},\mathbf{U}_{K}^{n})\\
\mathbf{U}_{K}^{(2)} & = & 2\mathbf{U}_{K}^{n}-\mathbf{U}_{K}^{(1)} & +{\displaystyle \frac{\Delta t^{n}}{2}}\mathbf{S}_{f}(\mathbf{U}_{K}^{(2)},\mathbf{U}_{K}^{n})\\
\mathbf{U}_{K}^{(3)} & = & \mathbf{U}_{K}^{n} & +\Delta t^{n}\mathbf{L}_{e}(\mathbf{U}_{K}^{(2)})\\
\mathbf{U}_{K}^{(4)} & = & \mathbf{U}_{K}^{(1)}+\mathbf{U}_{K}^{(2)}+\mathbf{U}_{K}^{(3)}-2\mathbf{U}_{K}^{n} & +{\displaystyle \frac{\Delta t^{n}}{2}}\mathbf{S}_{f}(\mathbf{U}_{K}^{(4)},\mathbf{U}_{K}^{n})\\
\mathbf{U}_{K}^{(5)} & = & \mathbf{U}_{K}^{n} & +\Delta t^{n}\mathbf{L}_{e}(\mathbf{U}_{K}^{(4)})\\
\mathbf{U}_{K}^{n+1} & = & {\displaystyle \frac{1}{2}}\left(\mathbf{U}_{K}^{(5)}-\mathbf{U}_{K}^{(3)}\right)+\mathbf{U}_{K}^{(4)}
\end{array}
\end{equation}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $\mathbf{L}_{e}(\mathbf{U}_{K}^{(l)})\equiv\mathbf{L}_{e}\left(\mathbf{U}_{K}^{(l)},\mathbf{U}_{\nabla,K}^{(l)},\mathbf{U}_{\nabla,K}^{*(l)};\mathbf{U}_{\nabla,K_{e}}^{*(l)};z_{K},z_{K_{e}},\mathbf{n}_{K}\right)$
\end_inset

 defined by (
\begin_inset CommandInset ref
LatexCommand ref
reference "def:Le"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
The three stages implicit part of this time splitting is a DIRK scheme 
\begin_inset CommandInset citation
LatexCommand cite
key "Pareschi2005"
literal "true"

\end_inset

 respecting A-stability, L-stability.
 It is stiffly accurate (
\begin_inset Formula $R(\infty)=0$
\end_inset

) , see 
\begin_inset CommandInset citation
LatexCommand cite
key "Hairer2004"
literal "true"

\end_inset

.
 Such stability properties enable to deal with wet/dry fronts where the
 friction source term 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 is extremely stiff.
 (
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 stiff because the water depth vanishes).
 
\end_layout

\begin_layout Standard
Moreover this version of the DIRK scheme has been found important to treat
 non trivial boundaries conditions without any special correction.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

This is the second order scheme implemented into the code.
\end_layout

\begin_layout Subsection
Boundary conditions
\end_layout

\begin_layout Standard
Recall that the current cell is denoted by 
\begin_inset Formula $K$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

left cell
\begin_inset Quotes erd
\end_inset

).
 It is here a in-domain cell.
 Here 
\begin_inset Formula $K_{e}$
\end_inset

 denotes the ghost cell (
\begin_inset Quotes eld
\end_inset

right cell
\begin_inset Quotes erd
\end_inset

).
 
\end_layout

\begin_layout Standard
The basic idea to impose the boundary conditions is to define ghost conservative
 vectors: 
\begin_inset Formula $\mathbf{U}_{K_{e}}^{G}$
\end_inset

 for the first order scheme and 
\begin_inset Formula $\mathbf{U}_{\nabla,K_{e}}^{G}$
\end_inset

 for the second order for an edge 
\begin_inset Formula $e$
\end_inset

 at the boundary of 
\begin_inset Formula $\Omega$
\end_inset

.
\end_layout

\begin_layout Standard
Note that it is not straightforward to impose a numerical flux value e.g.
 
\begin_inset Formula $Q_{in}(t)$
\end_inset

.
\begin_inset Newline newline
\end_inset

 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbf{U}_{K_{e}}^{G}$
\end_inset

 be the value of 
\begin_inset Formula $\mathbf{U}$
\end_inset

 in a virtual (ghost) cell 
\begin_inset Formula $K_{e}$
\end_inset

 adjacent to the boundary 
\begin_inset Formula $\partial\Omega$
\end_inset

.
\end_layout

\begin_layout Paragraph*

\series bold
Wall B.C.
 
\end_layout

\begin_layout Standard
The following local Riemann problems are solved: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccc}
h_{K_{e}}^{G} & = & h_{K}+(z_{K}-z_{K_{e}})\\
\hat{u}_{K_{e}}^{G} & = & -\hat{u_{K}}\\
\hat{v}_{K_{e}}^{G} & = & \hat{v}_{K}
\end{array}\right.\label{eq:bc_wall}
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph*
Imposed discharge: inflow discharge or rating curve at outflow
\end_layout

\begin_layout Standard
To impose 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $Q_{\text{in}}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 at 
\begin_inset Formula $\Gamma_{in}$
\end_inset

 or a rating curve 
\begin_inset Formula $Q_{out}(\eta)$
\end_inset

 at 
\begin_inset Formula $\Gamma_{out}$
\end_inset

, whatever the fluid rheology, the following primitive variables ghost values
 are set in the local Riemann solver:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccc}
h_{K_{e}}^{G} & = & h_{K}\\
\hat{u}_{K_{e}}^{G} & = & {\displaystyle \frac{Q_{\text{user}}h_{K}^{{\displaystyle \nicefrac{2}{3}}}}{\underset{e\in\Gamma_{\text{in}}}{\sum}h_{e,K}^{{\displaystyle \nicefrac{5}{3}}}m_{e}}}\\
\hat{v}_{K_{e}}^{G} & = & \hat{v}_{K}
\end{array}\right.\label{eq:bc_in}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $Q_{user}$
\end_inset

denotes either a given hydrogram 
\begin_inset Formula $Q_{in}(t)$
\end_inset

 (
\begin_inset Formula $m^{3}/s)$
\end_inset

, or a rating curve 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $Q_{out}(\eta)$
\end_inset

.
 
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
The latter may be 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
linearly interpoled function from tabulated
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 values.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
By setting: 
\begin_inset Formula $Q=u\ h\left(\sum m_{e}\right)$
\end_inset

 donc: 
\begin_inset Formula $u=\frac{Q}{\left(\sum m_{e}\right)h}\ $
\end_inset


\end_layout

\begin_layout Plain Layout
TO be clarifed / developed
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
TO BE CLARIFIED.
 
\end_layout

\begin_layout Plain Layout
One can easily verify that 
\begin_inset Formula $\underset{e\in\Gamma_{\text{in}}}{\sum}m_{e}\hat{q}_{K_{e}}^{G}=Q_{\text{in}}$
\end_inset

 OK ? 
\begin_inset Newline newline
\end_inset

and 
\begin_inset Formula $\hat{q}_{K_{e}}^{G}=c\:h_{K}^{{\displaystyle \nicefrac{5}{3}}}$
\end_inset

 sens de cela ??? bullshit ? 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Manning-Strickler law: 
\begin_inset Formula $Q=KAh^{2/3}\left(\nabla Z\right)^{1/2}$
\end_inset


\end_layout

\begin_layout Plain Layout
Rectangle geometry: 
\begin_inset Formula $Q=K\left(\sum m_{e}\right)h^{5/3}\left(\nabla Z\right)^{1/2}$
\end_inset


\end_layout

\begin_layout Plain Layout
Ghost longitudinal bathymetry = horizontal (
\begin_inset Formula $\nabla b=0$
\end_inset

): 
\begin_inset Formula $Q=K\left(\sum m_{e}\right)h^{5/3}\left(\nabla h\right)^{1/2}$
\end_inset


\end_layout

\begin_layout Plain Layout
Therefore: 
\begin_inset Formula $\frac{Q}{\left(\sum m_{e}\right)h^{5/3}}=K\left(\nabla h\right)^{1/2};$
\end_inset

So what ???
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Bullshit ???
\end_layout

\begin_layout Plain Layout
This last condition corresponds to the equilibrium between the gravitationnal
 and friction source terms.
\end_layout

\begin_layout Plain Layout
This boundary condition can be viewed as an approximation of the backwater
 curve since a Neumann boundary condition is applied for the water depth.
\end_layout

\end_inset

 If the wetted cross-section at the boundary is not rectangular, the computed
 discharge value in 
\begin_inset Formula $K$
\end_inset

 is a-priori not equal to the imposed value 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $Q_{\text{in}}$
\end_inset

 !...
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
To overcome this issue, a feedback process is applied on the ghost bathymetry
 
\begin_inset Formula $z_{K_{e}}$
\end_inset

 as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
z_{K_{e}}^{\text{new}}\ =\ z_{K_{e}}^{\text{old}}+cst\left(\mathbf{F}_{e}(\mathbf{U}_{K}^{n},\mathbf{U}_{K_{e}}^{n};\mathbf{n}_{e,K})-q_{K_{e}}^{G}\right)\label{eq:bc_in_correc}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where: 
\begin_inset Formula $q_{K_{e}}^{G}=h_{K}u_{K_{e}}^{G}$
\end_inset

(
\begin_inset Formula $m^{2}/s)$
\end_inset

 and 
\begin_inset Formula $cst$
\end_inset

 can be changed (
\begin_inset Formula $cst=0.1$
\end_inset

 by default).
 
\end_layout

\begin_layout Standard
This process correct the ghost bathymetry 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $z_{b}^{G}$
\end_inset

 
\family default
\series default
\shape default
\size default
\emph on
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
at each time step
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 to finally converge to a value implying that the mass flux 
\begin_inset Formula $\mathbf{F}_{e}^{h}(\mathbf{U}_{K}^{n},\mathbf{U}_{K_{e}}^{n},\mathbf{n}_{e,K})$
\end_inset

 is stricly equal to the imposed lineic discharge 
\begin_inset Formula $\hat{q}_{K_{e}}^{G}$
\end_inset

.
\end_layout

\begin_layout Paragraph*
Depth imposed
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
In order to control the 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
depth value
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 at 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
a boundary e.g.
 at 
\begin_inset Formula $\Gamma_{out}$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
, the following values are considered: 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Riemann invariant ? TO BE CLARIFIED with ref Guinot ? ...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ccc}
h_{K_{e}}^{G} & = & h_{\text{user}}\\
\hat{u}_{K_{e}}^{G} & = & \hat{u}_{K}+2\sqrt{g}\left(\sqrt{h_{user}}-\sqrt{h_{K}}\right)\\
\hat{v}_{K_{e}}^{G} & = & \hat{v}_{K}
\end{array}\right.\label{eq:bc_out}
\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph*
Second-order case
\end_layout

\begin_layout Standard
In the case of the second-order scheme, one has the 
\begin_inset Quotes eld
\end_inset

reconstructed
\begin_inset Quotes erd
\end_inset

 variable 
\begin_inset Formula $\mathbf{U}_{\nabla,K_{e}}^{G}$
\end_inset

; 
\begin_inset Formula $\mathbf{U}_{K_{e}}^{G}$
\end_inset

 is first used in the least square method (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ls_muscl"

\end_inset

) to compute the vectorial slope in the interior cell 
\begin_inset Formula $K$
\end_inset

.
 
\end_layout

\begin_layout Standard
The conditions (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bc_wall"

\end_inset

), (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bc_in"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bc_out"

\end_inset

) are then used a second time replacing 
\begin_inset Formula $\mathbf{U}_{K}$
\end_inset

 by 
\begin_inset Formula $\mathbf{U}_{\nabla,K}$
\end_inset

 to obtain 
\begin_inset Formula $\mathbf{U}_{\nabla,K_{e}}^{G}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Finally, the hydrostatic reconstructed depth 
\begin_inset Formula $h_{K_{e}}^{^{*},G}$
\end_inset

 and 
\begin_inset Formula $h_{\nabla,K_{e}}^{^{*},G}$
\end_inset

 are calculated in the same way through equations (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:hydrostatic_h"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:hydrostatic_h_nabla"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with 
\begin_inset Formula $z_{\nabla,K_{e}}^{G}=z_{\nabla,K_{e}}$
\end_inset

.
\end_layout

\begin_layout Section
Validation
\end_layout

\begin_layout Standard
This section is dedicated to the validation of the numerical schemes implemented
 in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
DassFlow{}
\end_layout

\end_inset

 software presenting several challenging and relevant test cases in context
 of hydraulic and environnemental studies : dam break, channel and run-up
 problems with dynamic wet/dry fronts and considering non-linear friction.
 We will show the formally global second-order convergence in space and
 time of our SW numerical model with the Manning-Strickler friction source
 term as the robust treatment of wet/dry fronts.
\end_layout

\begin_layout Standard
In order to quantify the numerical errors, we define these relative error
 norms,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
e_{p}(x)={\displaystyle {\displaystyle \frac{\Vert x^{\text{num}}-x^{\text{exact}}\Vert_{p}}{\Vert x^{\text{exact}}\Vert_{p}}\quad}},\quad e_{p}^{T}(x)={\displaystyle \frac{1}{T}\int_{0}^{T}e_{p}(x)\ dt}\\
\\
\Vert x\Vert_{p}=\left({\displaystyle \sum_{K\in\Omega}m_{K}\left|x_{K}\right|^{p}}\right)^{1/p}
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $x^{\text{num}}$
\end_inset

 is the numerical solution with 
\begin_inset Formula $n$
\end_inset

 cells of discretization and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $x^{\text{exact}}$
\end_inset

 is the analytical solution of the test case or the converge reference solution
 when the analytical solution is not known (
\begin_inset Formula $x_{i}^{\text{exact}}$
\end_inset

 is properly numerically integrated with desired accuracy in sense of used
 Finite Volume schemes).
\end_layout

\begin_layout Subsection
Water at rest
\end_layout

\begin_layout Standard
We consider in a box 
\begin_inset Formula $1000$
\end_inset

 meter long a zero bed elevation, ramdomly perturbated cell by cell with
 a maximum amplitude of 
\begin_inset Formula $1\ m$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
z_{b}=r\quad\text{with}\quad r\in\left[-1,1\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If the simualtion is initialized with a water elevation of zero, i.e.
 
\begin_inset Formula $z_{b}+h=0$
\end_inset

, the resulting 
\begin_inset Quotes eld
\end_inset

lake
\begin_inset Quotes erd
\end_inset

 should stay at rest.
 After a simulation time of 
\begin_inset Formula $3600\ s$
\end_inset

, the results with different schemes are showed in the Fig.
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:water-at-rest"

\end_inset

.
 The norms of the final velocities are given in the Tab.
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Water-at-rest"

\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top" width="5text%">
<column alignment="center" valignment="top" width="10text%">
<column alignment="center" valignment="top" width="10text%">
<column alignment="center" valignment="top" width="10text%">
<column alignment="center" valignment="top" width="10text%">
<column alignment="center" valignment="top" width="10text%">
<column alignment="center" valignment="top" width="10text%">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1°order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1°order / WB-A
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2°order
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2°order / MP limiter / WB-A / CFL 0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2°order/ MP limiter / WB-A / CFL 0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2°order/ Barth limiter / WB-A
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Vert\mathbf{u}\Vert_{\infty}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.30$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.04\ 10^{-13}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.23$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.45\ 10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.66\ 10^{-14}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.66\ 10^{-14}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Vert\mathbf{u}\Vert_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.14$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.92\ 10^{-16}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.95$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.95\ 10^{-5}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.40\ 10^{-16}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.97\ 10^{-16}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Water at rest test case, absolute infinity and 
\begin_inset Formula $L_{1}$
\end_inset

 norms of the final velocities.
\begin_inset CommandInset label
LatexCommand label
name "tab:Water-at-rest"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/water_at_rest_first.pdf
	lyxscale 60
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/water_at_rest_first_b1.pdf
	lyxscale 60
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/water_at_rest_muscl_b1_cfl_0.5.pdf
	lyxscale 60
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/water_at_rest_muscl_b1_b.pdf
	lyxscale 60
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Water at rest test case, final water depth and velocities; (up-left) first
 order scheme; (up-right) well-balanced first order scheme; (down-left)
 well-balanced second order scheme with the MP limiter and a CFL number
 of 
\begin_inset Formula $0.5$
\end_inset

; (down-right) well-balanced second order scheme with the Barth limiter.
\begin_inset CommandInset label
LatexCommand label
name "fig:water-at-rest"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Parabolic bowl with linear friction
\end_layout

\begin_layout Standard
Analytical solutions of the nonlinear SW equations considering a linear
 friction and a parabolic bottom topography were derived by Sampson 
\begin_inset CommandInset citation
LatexCommand cite
key "Sampson2006"
literal "true"

\end_inset

, following the work of Thacker 
\begin_inset CommandInset citation
LatexCommand cite
key "Thacker1981"
literal "true"

\end_inset

, by considering a linear friction in replacement of Coriolis force.
 These solutions involve a flat surface oscillating motion with wet/dry
 fronts, decaying over time because of friction.
 It gives a very popular test for a SW numerical solver 
\begin_inset CommandInset citation
LatexCommand cite
key "Audusse2005,Liang2009,Song2011,Kesserwani2012,Hou2013"
literal "true"

\end_inset

.
 The solution is,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{ccl}
\eta(x,t) & = & h_{0}+{\displaystyle \frac{a^{^{2}}B^{^{2}}e^{-\tau t}}{8g^{^{2}}h_{0}}\left({\displaystyle -s\tau}\sin2st+\left({\displaystyle \frac{\tau^{2}}{4}-s^{^{2}}}\right)\cos2st\right)}\\
 &  & -{\displaystyle \frac{B^{2}e^{-\tau t}}{4g}-{\displaystyle \frac{e^{-\tau t/2}}{g}}\left(Bs\cos st+{\displaystyle \frac{\tau B}{2}\sin st}\right)x}\\
\\
u(x,t) & = & Be^{-\tau t/2}\sin st
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $p=\sqrt{{\displaystyle 8gh_{0}}}/a$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 and 
\begin_inset Formula $s={\displaystyle \sqrt{p^{2}-\tau^{2}}/2}$
\end_inset

 (and then valid if 
\begin_inset Formula $p>\tau$
\end_inset

).
 We choose two set of parameters,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\text{set 1}\ \ \left\{ \begin{array}{ccc}
h_{0} & = & 10\ m\\
a & = & 3000\ m\\
B & = & 5\ m.s^{-1}\\
\tau & = & 0.001\ s^{-1}
\end{array}\qquad\right.\text{set 2}\ \ \left\{ \begin{array}{ccc}
h_{0} & = & 1\ m\\
a & = & 30\ m\\
B & = & 1\ m.s^{-1}\\
\tau & = & 0.2\ s^{-1}
\end{array}\right.\label{eq:set-bowl}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The first one corresponding to the classic parameters chosen into litterature
 as in 
\begin_inset CommandInset citation
LatexCommand cite
key "Liang2009,Kesserwani2012"
literal "true"

\end_inset

.
 The Fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:bowl_norms"

\end_inset

) shows the calculated relative error norms 
\begin_inset Formula $e_{1}^{T}(h)$
\end_inset

 with this first set of parameters using the MP limiter for the second order
 well-balanced scheme.
 One can observe the correct convergence behavior of all well-balance schemes
 and demonstrate that the moving wet-dry fronts are robustly captured (a
 cut-off water depth 
\begin_inset Formula $h_{\epsilon}\in\left[10^{-4},10^{-8}\right]$
\end_inset

 have been used for these simulations in order to find a linear convergence
 behavior in log-log scale).
 A rate of convergence of approximatively 1.5 is found for the second-order
 well-balance scheme with the hybrid SSP-RK2 time splitting as with the
 IMEX time splitting (It is found a relative error norm 
\begin_inset Formula $e_{1}^{T}(h)\simeq2.10^{-3}$
\end_inset

 for 
\begin_inset Formula $n=100$
\end_inset

 which is approximatively the same in 
\begin_inset CommandInset citation
LatexCommand cite
key "Liang2009"
literal "true"

\end_inset

).
 This loss of second order accuracy is most probably due to the presence
 of the two moving wet/dry fronts introducing singularities in the solution.
 But a most interesting observation is that there is no major difference
 between the two time splitting strategy despite the fact that the hybrid
 RK2 is first order accurate and the IMEX second order accurate, except
 maybe for very fine meshes.
 This demonstrates that the spatial consistency error is greater than the
 time one despite the accuracy slopes difference.
 If simulations are performed now with the second set of paramaters (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:set-bowl"

\end_inset

), then it is obtained a significant difference between the two time splitting
 methods Fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:bowl_norms"

\end_inset

).
 After an asymptotic first order behavior for coarse meshes, the hybrid
 RK2 time splitting gives a rate of convergence of 1 and the IMEX time splitting
 maintains the same 1.5 rate of convergence obtained with the first classic
 set of parameters (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:set-bowl"

\end_inset

).
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/thacker_conv.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/thacker_conv_splitting_error.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
(left) Rate of convergence for the norm 
\begin_inset Formula $e_{1}^{T}(h)$
\end_inset

 with set 1 of physical parameters, 
\begin_inset Formula $n$
\end_inset

 is the cells number (right) Same with set 2.
\begin_inset CommandInset label
LatexCommand label
name "fig:bowl_norms"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
Nevertheless, the friction source term is linear for these simulations and
 it do not corresponds to our original model where the Manning-Strickler
 friction source term is non-linear.
 The singularities at the moving wet/dry fronts cannot guarantee to measure
 precisely the right accuracy of the numerical methods of regular solutions.
 In conclusion, this test case is interesting to check robustness to deal
 with wet/dry fronts, but largely insufficient to be relevant to test the
 behavior of our numerical solver in context of hydraulic and environnemental
 studies.
\end_layout

\begin_layout Subsection
Dam break(s) with slope and non-linear friction
\end_layout

\begin_layout Standard
Numerical model behavior is investigated for dam break problems with a non
 zero slope and with the non-linear Manning-Strickler friction source term
 vanishing with the water depth at wet/dry front.
\end_layout

\begin_layout Subsubsection
\begin_inset Quotes eld
\end_inset

Failling Gaussian
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
A 
\begin_inset Quotes eld
\end_inset

regularised
\begin_inset Quotes erd
\end_inset

 dam break problem is first performed in sense that all eventual singularities
 in numerical solution are eliminated by construction.
 Considering the following initial condition,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{rclccc}
z_{b}(x) & = &  &  & 0.5\  & e^{-{\displaystyle \frac{\left(x-l_{x}/2\right)^{2}}{2\ \sigma^{2}}}}\\
h(x,t=0) & = & 0.1 & + & 0.5\  & e^{-{\displaystyle \frac{\left(x-l_{x}/2\right)^{2}}{2\ \sigma^{2}}}}
\end{array}\right.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $\sigma=100\ m$
\end_inset

, a computational domain lenght 
\begin_inset Formula $l_{x}=1000\ m$
\end_inset

, a Manning-Strickler roughness coefficient 
\begin_inset Formula $n=0.05$
\end_inset

 and a gravitational acceleration 
\begin_inset Formula $g=10\ m.s^{-1}$
\end_inset

, a converge simulation is performed with a 12800 cells mesh at time 
\begin_inset Formula $t=100\ s$
\end_inset

.
 Initial condition and converge result are plotted in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:falling_gaussian"

\end_inset

.
 One can note that these parameters are suitable in context of hydraulic.
 The topography gradient is chosen not constant in order to avoid an exact
 calculation of the topography gradient.
 The rates of convergence for the norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 and 
\begin_inset Formula $e_{1}(q)$
\end_inset

 showed on Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:falling_gaussian"

\end_inset

 give a very clear accuracy result.
 As the hybrid RK2 time stepping method is only first order accurate, the
 same overall first order convergence rate is found than for the spatial
 first order well-balanced scheme.
 The relative error norms are still smaller in significant proportion due
 to the enhanced spatial accuracy at second order.
 Concerning the IMEX time stepping method, a second-order rate of convergence
 is found.
 As a consequence, the relative error norms become very small even for very
 coarse meshes.
 This demonstrates the global second-order convergence rate of presented
 numerical model with MUSCL linear reconstruction with appropriate limitation
 and IMEX time stepping.
 Nevertheless, one may be careful that this rate of convergence will be
 smaller with singularities in numerical solution as with non trivial boundary
 conditions.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/falling_gaussian_conv.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/falling_gaussian_xy.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
(left) Rates of convergence for the norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 and 
\begin_inset Formula $e_{1}(q)$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

 is the cells number (right) Half-domain initial condition, converge simulation
 with 12800 cells and relative simulations with 25 cells.
\begin_inset CommandInset label
LatexCommand label
name "fig:falling_gaussian"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Flat slope and wet/dry front
\end_layout

\begin_layout Standard
The idealized dam break problem involving a dynamic wet/dry front is now
 investigated.
 The non-linear Manning-Strickler friction is taken into account and a non
 zero flat slope is considered as it is sketched in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dambreak-sketch"

\end_inset

.
 The parameters used are a computational domain length 
\begin_inset Formula $l_{x}=1000\ m$
\end_inset

 with wall boundaries at each side, a slope 
\begin_inset Formula $s=0.5\ \%$
\end_inset

, a Manning-Strickler roughness coefficient 
\begin_inset Formula $n=0.05$
\end_inset

 and a gravitational acceleration 
\begin_inset Formula $g=10\ m.s^{-1}$
\end_inset

.
 The water column has a length 
\begin_inset Formula $L=50\ m$
\end_inset

 and two height are considered, 
\begin_inset Formula $H=1\ \text{or}\ 5\ m$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/dambreak.svg
	lyxscale 50
	width 40text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
dam-break problem sketch.
\begin_inset CommandInset label
LatexCommand label
name "fig:dambreak-sketch"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As no analytical solution can be derived, two converge simulations are again
 performed with 12800 cells for 
\begin_inset Formula $H=5\ m$
\end_inset

 at time 
\begin_inset Formula $t=500\ s$
\end_inset

 and for 
\begin_inset Formula $H=1\ m$
\end_inset

 at time 
\begin_inset Formula $t=2000\ s$
\end_inset

.
 After the initial simulation time, a rarefaction wave goes upstream and
 interacts with the left wall boundary while a shock wave goes downstream,
 both modifing the initial water column shape.
 After a sufficient simulation time, the water column completly disappears
 and the new water shape exhibits more mass and stronger gradients downstream.
 The dynamic wet/dry front is robustly captured by well-balanced first-
 and second-order schemes without any cut-off water depth 
\begin_inset Formula $h_{\epsilon}$
\end_inset

 , despite that the well-balanced property is needless for this problem.
 We have verify that the schemes are stricly positive and do not generate
 any negative water depth.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/dam_h_5_conv.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/dam_h_5.pdf
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Idealized dam break problem with 
\begin_inset Formula $H=5\ m$
\end_inset

.
 (left) rates of convergence for the norm 
\begin_inset Formula $e_{1}(h)$
\end_inset

 for different schemes; (right) corresponding initial condition, converge
 simulation with 12800 cells and results with 100 cells.
\begin_inset CommandInset label
LatexCommand label
name "fig:dam-break_h_5"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/dam_h_1_conv.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/dam_h_1.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Idealized dam break problem with 
\begin_inset Formula $H=1\ m$
\end_inset

.
 (left) rates of convergence for the norm 
\begin_inset Formula $e_{1}(h)$
\end_inset

 for different schemes; (right) corresponding initial condition, converge
 simulation with 12800 cells and results with 100 cells.
\begin_inset CommandInset label
LatexCommand label
name "fig:dam-break_h_1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Observing the relative error norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dam-break_h_5"

\end_inset

 and Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dam-break_h_1"

\end_inset

, on can first note that the previous obtained second-order convergence
 rate is loosed due to the singularities in the numerical solution and especiall
y at wet/dry front.
 Nevertheless, the relative error norm 
\begin_inset Formula $e_{1}(h)$
\end_inset

 is smaller for a given grid size using the IMEX time stepping rather than
 the hybrid RK2 one and even more comparatively to the first order schemes.
 If there is no major difference between the schemes with or without the
 well-balanced property when initially 
\begin_inset Formula $H=5\ m$
\end_inset

, this difference is obvious when 
\begin_inset Formula $H=1\ m$
\end_inset

.
 The well-balanced second-order scheme with the hybrid RK2 time stepping
 gives a result very similar to the first order scheme without the well-balanced
 property.
 This indicates a drawback in both well-balanced methods when the water
 depth is close to the bathymetry difference.
 Sufficiently important to give very wrong numerical solutions with first
 order schemes.
 In conclusion, in order to use these methods to simulate hydraulic flows,
 one may be careful to verify this criteria to produce meshes.
\end_layout

\begin_layout Subsection
simple channel
\end_layout

\begin_layout Standard
In order to perform river flood simulations with real topography, it is
 interesting now to check the numerical model behavior to simulate an open-chann
el flow with a non constant topography gradient.
\end_layout

\begin_layout Subsubsection
Mac Donald's benchmark
\end_layout

\begin_layout Standard
As it would be too restrictive to consider a channel with a constant topography
 gradient, the Mac Donald's analytic steady solution for open-channel flow
 is prefered 
\begin_inset CommandInset citation
LatexCommand cite
key "MacDonald1997"
literal "true"

\end_inset

.
 Making the hypothesis of a contant discharge in space, it can be easily
 verify that the steady states verify,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
\partial_{t}h=\partial_{t}q=\partial_{x}q=0\\
\\
\partial_{x}z_{b}=\left({\displaystyle \frac{q^{2}}{gh^{3}}-1}\right)\partial_{x}h-{\displaystyle \frac{n^{2}q^{2}}{h^{10/3}}}
\end{array}\label{eq:open-channel-sol}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
that gives analytical steady solutions with a non necessary constant topography
 gradient.
 We consider like in 
\begin_inset CommandInset citation
LatexCommand cite
key "Delestre2012"
literal "true"

\end_inset

 a computational domain lenght 
\begin_inset Formula $l_{x}=1000\ m$
\end_inset

, a lineic discharge 
\begin_inset Formula $q=2\ m^{2}/s$
\end_inset

 and a Manning-Strickler roughness coefficient 
\begin_inset Formula $n=0.033$
\end_inset

.
 Considering this exact water depth,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h^{\text{exact}}(x)=\left({\displaystyle \frac{4}{g}}\right)^{1/3}\left(1+{\displaystyle \frac{1}{2}\exp\left(-16\left({\displaystyle \frac{x}{1000}-\frac{1}{2}}\right)^{2}\right)}\right)\label{eq:mcdonald_exact_h}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
insuring that the flow is subcritical in all the channel, the bottom topography
 is numerically integrated with appropriate accurary that gives the xyplot
 Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mcdonald_sol"

\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/channel_exact.pdf
	lyxscale 40
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Open-channel steady state solution (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:open-channel-sol"

\end_inset

) considering the exact water depth (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mcdonald_exact_h"

\end_inset

).
 
\begin_inset CommandInset label
LatexCommand label
name "fig:mcdonald_sol"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The discharge is imposed upstream of the flow and the exact water depth
 is prescribed downstream.
 Initialising the simulations with dry cells except at the first cell at
 inflow, the steady states are properly achieved in time.
 The relative error norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 and 
\begin_inset Formula $e_{1}(q)$
\end_inset

 showed in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mcdonald_res"

\end_inset

 give the same result than for the previous 
\begin_inset Quotes eld
\end_inset

regularised
\begin_inset Quotes erd
\end_inset

 dam break problem.
 The well-balanced second order scheme with the hybrid RK2 time stepping
 is only first order accurate with a smaller error than for the first order
 whereas with the IMEX time stepping the numerical model is formally at
 second order with very small errors even for very coarse meshes.
 A surprising result is that this rate of convergence is obtained with non
 trivial inflow/outflow boundary conditions even if this benchmark problem
 is only onedimensional.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/channel_conv.pdf
	lyxscale 40
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/channel_xy.pdf
	lyxscale 40
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Open-channel benchmark results : (left) relative error norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 and 
\begin_inset Formula $e_{1}(q)$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

 is the cells number; (right) exact solutions for 
\begin_inset Formula $h$
\end_inset

 and 
\begin_inset Formula $u$
\end_inset

 and simulations with 25 cells.
\begin_inset CommandInset label
LatexCommand label
name "fig:mcdonald_res"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
perturbed topography
\end_layout

\begin_layout Standard
The topography is not so smooth in real-life than in the previous test case
 where a channel 
\begin_inset Formula $1000\ m$
\end_inset

 long was considered.
 It is tested here the numerical model introducing gradually in frequency
 some perturbations to an initial channel 
\begin_inset Formula $10000\ m$
\end_inset

 long with a constant slope of 
\begin_inset Formula $0,25\ \%$
\end_inset

 such that,\SpecialChar ligaturebreak

\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
{\displaystyle z_{b}=z_{b}+\sum_{i=1}^{n_{p}}0.25\sin\left({\displaystyle 2\pi\left({\displaystyle \frac{p_{i}\ x}{l_{x}}}+r_{i}\right)}\right)}\quad\text{with}\quad r_{i}\in\left[0,1\right]\end{array}\label{eq:channel_perturb}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $n_{p}=1,2,3,4,5\ \text{and}\ 6$
\end_inset

 and 
\begin_inset Formula $p_{i}=7,24,57,108,205\ \text{and}\ 402$
\end_inset

.
 In order to control the flow at inflow and outflow, and especially the
 backwater curve at the inflow, the topography gradient is kept constant
 close to taking care to maintain perburtations spatially continuous.
 The other parameters are a Manning-Strickler roughness coefficient 
\begin_inset Formula $n=0.05$
\end_inset

, a lineic discharge 
\begin_inset Formula $q=1\ m^{2}/s$
\end_inset

 and a gravitational acceleration 
\begin_inset Formula $g=10\ m.s^{-1}$
\end_inset

.
 Since the exact solution for the initial constant slope channel is 
\begin_inset Formula $h=1\ m$
\end_inset

 (and 
\begin_inset Formula $u=1\ m/s$
\end_inset

), the topography perturbations are of the same order of magnitude.
 The opposite case would be obviously irrelevant.
 Main goal is to find a criteria that insures a good accuracy to apply the
 numerical model with real topography.
 Simulations are performed with the well-balanced second-order scheme and
 the IMEX time stepping until the steady state is properly found.
 For each of these six cases, a converge simulation is performed with 12800
 cells of discretization showed at the left of the Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:channel_perturb_res"

\end_inset

.
 One can note that the flow respects the SW model hypothesis since the smaller
 wavelength has a value of 
\begin_inset Formula $25\ h$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/perturb_bathy_channel_exact.pdf
	lyxscale 40
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/perturb_bathy_channel_conv.pdf
	lyxscale 40
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Channel 
\begin_inset Formula $10000\ m$
\end_inset

 long with a constant slope of 
\begin_inset Formula $0,25\ \%$
\end_inset

 introducing gradually in frequency some perturbations in topography according
 to (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:channel_perturb"

\end_inset

) : (left) six cases with channel bottom topography and associated converge
 simulations; (right) associated relative error norm 
\begin_inset Formula $e_{1}(h)$
\end_inset

 with 
\begin_inset Formula $n$
\end_inset

 cells of discretization (the greyer zone corresponds to less than 4 cells
 of discretization for the highest frequency for each case).
\begin_inset CommandInset label
LatexCommand label
name "fig:channel_perturb_res"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The calculation of the relative error norms 
\begin_inset Formula $e_{1}(h)$
\end_inset

 evolving the mesh step size 
\begin_inset Formula $n$
\end_inset

 shows in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:channel_perturb_res"

\end_inset

 that introducing gradually in frequency some perturbations in the topography
 damages the simulations accuracy.
 This phenomenom is in a first time likely proportional to the highest perturbat
ion frequency before saturing when the mesh is too coarse comparatively
 to the highest frequency introduced.
 The criteria to maintain a good accuracy as the right correct second-order
 convergence rate is to discretize the channel topography with a minimum
 of four points for the highest perturbation frequency.
\end_layout

\begin_layout Subsection
Solitary wave on a simple beach
\end_layout

\begin_layout Standard
It is well know that the SW equations can be a suitable model to study numerical
ly storm surges as the complete life-cycle of a tsunami (generation, propagation
 and run-up on the coast).
 The classic benchmark problem was introduced by Synolakis and al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Synolakis1987"
literal "true"

\end_inset

 deriving an adimensionnal analytical solution for the run-up of a solitary
 wave on a simple sloping beach.
 Following the parameters retained in the NOAA technical report for evaluation
 of tsunami numerical models 
\begin_inset CommandInset citation
LatexCommand cite
key "Synolakis2007"
literal "true"

\end_inset

, the initial condition with dimensional parameters sketched in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:beach_sketch"

\end_inset

 is,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\eta(x,0)=H\ sech^{^{2}}\left(\gamma\left({\displaystyle \frac{x-x_{0}-L}{d}}\right)\right)\quad\text{and}\quad u(x,0)=-\sqrt{{\displaystyle \frac{g}{d}}}\ \eta(x,0)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
with 
\begin_inset Formula $\cot\beta=19.85$
\end_inset

, 
\begin_inset Formula $\gamma=\sqrt{3H/4d}$
\end_inset

 and 
\begin_inset Formula $L=\text{arccosh}\left(\sqrt{20}\right)/\gamma$
\end_inset

.
 The wave height satifies the adimendional parameter 
\begin_inset Formula $H/d=0.0185$
\end_inset

.
 The computational domain is 
\begin_inset Formula $100\:d$
\end_inset

 long, the mesh step size respects 
\begin_inset Formula $\Delta x=d/10$
\end_inset

 and wall boundaries conditions are prescribed.
 Using the well-balanced second-order numerical scheme with the MP limter
 and IMEX time stepping, resulting water levels profiles and two time series
 are plotted in Fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:beach_res"

\end_inset

 as superposed the nonlinear analytical solution.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/plane_beach.svg
	lyxscale 75
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Dimensional sketch of the solitiary wave run-up benchmark problem sketch.
\begin_inset CommandInset label
LatexCommand label
name "fig:beach_sketch"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Float figure
placement tbh
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/beach_t_35_45_55_65.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/leo/Desktop/SVN/dassflow-2d/trunk/doc/figs/beach_x_0.25_9.95.pdf
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Run-up of a solitiary wave on a simple beach : comparison of analytical
 solution (scatters) versus numerical solution (solid lines).
\begin_inset CommandInset label
LatexCommand label
name "fig:beach_res"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
According to Synolakis and al.
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Synolakis2007"
literal "true"

\end_inset

 page 5, “
\shape italic
any well benchmarked code should produce results within 5% of the calculated
 value from the analytical solution
\shape default

\begin_inset Quotes erd
\end_inset

 which is the case for our simulation which is spatially everywhere very
 close to the analytical solution.
 There is no particular 
\begin_inset Quotes eld
\end_inset

distortion
\begin_inset Quotes erd
\end_inset

 in the numerical solution at adimensional time 
\begin_inset Formula $t/\tau=45\ \text{and}\ 65$
\end_inset

 in proximity to the wet/dry front whereas other numerical models can produce
 some like it is showed in the NTHMP workshop report 
\begin_inset CommandInset citation
LatexCommand cite
key "2012"
literal "true"

\end_inset

.
 This demonstrates that our well-balanced treatment at wet/dry front do
 not affect a wave run-up computation accuracy.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "references"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
